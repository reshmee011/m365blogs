<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP | m365 blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups.">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
      <link href="/metalogix-import-from-fileshare-to-sharepoint-extract-folder-name-from-filepath-using-csom-pnp/index.xml" rel="alternate" type="application/rss+xml" title="m365 blog" />
      <link href="/metalogix-import-from-fileshare-to-sharepoint-extract-folder-name-from-filepath-using-csom-pnp/index.xml" rel="feed" type="application/rss+xml" title="m365 blog" />
      
    
    
    <meta property="og:title" content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP" />
<meta property="og:description" content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/metalogix-import-from-fileshare-to-sharepoint-extract-folder-name-from-filepath-using-csom-pnp/" /><meta property="article:section" content="" />
<meta property="article:published_time" content="2016-08-26T21:05:05+00:00" />
<meta property="article:modified_time" content="2016-08-26T21:05:05+00:00" />
<meta itemprop="name" content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP">
<meta itemprop="description" content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."><meta itemprop="datePublished" content="2016-08-26T21:05:05+00:00" />
<meta itemprop="dateModified" content="2016-08-26T21:05:05+00:00" />
<meta itemprop="wordCount" content="552">
<meta itemprop="keywords" content="CSOM,FilePath Extract Folder Name,Metalogix,Metalogix FileShare,PnP,SharePoint 2013," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP"/>
<meta name="twitter:description" content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        m365 blog
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>


    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <h1 class="f1">
          Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links mid-gray">
        <p>I was evaluating the <a href="http://www.metalogix.com/Products/Content-Matrix.aspx">Metalogix tool</a> for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:</p>
<ul>
<li>Migrate files recursively from within folders , i.e. flatten folder</li>
<li>Replace illegal characters with character specified</li>
<li>Handle duplicate by either overwriting file or not moving file</li>
<li>The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns</li>
<li>Can apply custom filter on the following
<ul>
<li>Created Before</li>
<li>Created After</li>
<li>Modified Before</li>
<li>Modified After</li>
<li>File Size Max</li>
</ul>
</li>
</ul>
<p><img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixcustomfilters.png" alt="MetalogixCustomFilters"></p>
<ul>
<li>Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups.</li>
<li>Can migrate sub folders</li>
<li>Incremental migrate</li>
<li>Migration can be scheduled, in scenario where migration needs to be run out of office hours</li>
<li>Can extract custom properties on file using “Extracting MS Office File Properties”</li>
</ul>
<p>I was stuck how to extract different level of folder names for nested folders. The folder names represent useful metadata which we wanted to migrate also. I managed to extract the top level folder using RegEx expression. I created a new column &ldquo;Folder&rdquo; from the &ldquo;Items View &ldquo;tab for the file share location. Right clicking on the view brings the option &ldquo;Extract Content from Property&rdquo; . <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractcontentfromproperty.png" alt="MetalogixExtractContentFromProperty"> I used Regex ** [^\\]+(?=\\[^\\]+$)** on the Metalogix [Source Url] column and extracted the result to column [Folder] created above. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderusingregex.png" alt="MetalogixExtractFolderUsingRegex"> After running the extraction, the column Folder is correctly populated with the folder name in which the file resides. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfoldername.png" alt="MetalogixExtractFolderName"> I was trying to figure out how to retrieve various folder levels from a path and map them to different columns. Let&rsquo;s say the folder structure is \Server\First Level Folder\Second Level Folder\Third Level Folder\My File.extension From the above method I managed to retrieve only [Third Level Folder] name. If I want to retrieve [Second Level Folder], then I have to use a different regex together <strong>^(?:[^\\]*\\){4}([^\\]*)</strong> with the regex above ** [^\\]+(?=\\[^\\]+$)** <em>The number {4} can be updated to get different folder levels.</em> The regex can be tested from Windows PowerShell and correct result is returned by applying both regex expressions. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/testregextoretrievedifferentlevel.png" alt="TestRegexToRetrieveDifferentLevel"> I created two additional columns [tmpLevel1] and [Level1] from the file share location [Items View] tab. Using the  regex <strong>^(?:[^\\]*\\){4}([^\\]*),</strong> I extracted the path into column [tmpLevel1] which is in the format &quot; \Server\First Level Folder\Second Level Folder\Third Level Folder&rdquo; <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelusingregex.png" alt="MetalogixExtractFolderLevelUsingRegex"> I repeated the process but this time using <strong>[^\\]+(?=\\[^\\]+$)</strong> on column [tmpLevel1] to save result in column [Level1]. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelfinalusingregex.png" alt="MetalogixExtractFolderLevelFinalUsingRegex"> The final results is now I have the third level and second level folder name.<img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelresultspng.png" alt="MetalogixExtractFolderLevelResultspng"> The issue however is that the steps need to be repeated for each new file share location making the deployment steps quite cumbersome. The other option is to keep the migration step simple mapping just Out of Box fields. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixfieldmappings.png" alt="MetalogixFieldMappings"> After files are migrated to SharePoint, the column [MigrationSourceURL] is created and populated by default in the library. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixmigrationsourceurl.png" alt="MetalogixMigrationSourceURL"> Thus running the PowerShell using CSOM script below after migration the columns Level0 and Level1 can be populated with the folder names. The value from column &ldquo;MigrationSourceURL&rdquo; is retrieved for all documents and split into level 0 and level 1. <a href="https://gist.github.com/reshmee011/dfe0b6fa3eb3d8f59e9d0415f66662d7">https://gist.github.com/reshmee011/dfe0b6fa3eb3d8f59e9d0415f66662d7</a> After running the script, the Level0 and Level1 columns are populated. <img src="https://reshmeeauckloo.files.wordpress.com/2016/08/documentslevel01afterpwcsom.png" alt="DocumentsLevel01AfterPWCSOM"></p>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://famous-cajeta-4dad83.netlify.app/" >
    &copy;  m365 blog 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
