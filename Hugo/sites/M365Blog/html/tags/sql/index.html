<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>SQL | m365 blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
      <link href="/tags/sql/index.xml" rel="alternate" type="application/rss+xml" title="m365 blog" />
      <link href="/tags/sql/index.xml" rel="feed" type="application/rss+xml" title="m365 blog" />
      
    
    
    <meta property="og:title" content="SQL" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/tags/sql/" />
<meta itemprop="name" content="SQL">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SQL"/>
<meta name="twitter:description" content=""/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        m365 blog
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          SQL
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="cf pa3 pa4-m pa4-l">
    <div class="measure-wide-l center f4 lh-copy nested-copy-line-height nested-links mid-gray">
      <p>Below you will find pages that utilize the taxonomy term “SQL”</p>
    </div>
  </article>
  <div class="mw8 center">
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/migrate-data-from-one-sql-table-to-another-database-table/" class="link black dim">
        Migrate data from one SQL table to another database table
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Sometimes you may have to migrate data from one SQL database to another SQL database on another environment, e.g. Live to test and dev environment and vice versa. You may argue the easiest solution is a migration of the backup of database. Unfortunately it does not work well in environments where data in Live is classified as sensitive and are not allowed to be copied across into a dev / test machine where the security is not as strict as a live machine.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/rebuild-and-reorganize-indexes-on-all-tables-in-ms-database/" class="link black dim">
        Rebuild and Reorganize indexes on all tables in MS database
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      As part of database maintenance, indexes on databases have to be rebuilt or reorganised depending on how fragmented the indexes are. From the article Reorganize and Rebuild Indexes, the advice is to reorganise index if avg_fragmentation_in_percent value is between 5 and 30 and to rebuild index if it is more than 30%. The script below queries all fragmented indexes more than 5 percent and using a cursor a loop is performed on the results to rebuild or reorganise indexes depending on the percentage of fragmentation using dynamic SQL, i.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-script-batch-execution-using-sqlcmd-in-powershell-comments/" class="link black dim">
        SQL script batch execution using sqlcmd in PowerShell
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      reshmee011 - May 1, 2017
Definitely you can without a manifest file. If you want the scripts to run in some order, you can append a numerical number to the script file. Let me know if you need a sample code.
This example is great. Really helped me understand a few more things about PowerShell. But is it possible to do the same thing without using a manifest file (i.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-script-batch-execution-using-sqlcmd-in-powershell/" class="link black dim">
        SQL script batch execution using sqlcmd in PowerShell
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      There is often a mismatch between needs of the development team (multiple discreet T-SQL files for separate concerns) and the release team (the requirement for one step automated deployment) . The script bridges the requirement by using sqlcmd.exe to run a batch of SQL scripts. A text file is used listing all sql files that need to run in a particular order to avoid errors which may occur if there are dependencies between the scripts.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/add-ssrs-report-to-project-detail-page-project-server/" class="link black dim">
        Add SSRS report to Project Detail Page Project Server
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Often clients want to be able to drill down to SSRS reports with the project pre selected when they are viewing project information from project detail pages. This post describes how to embed SSRS report in a project detail page.
Add SSRS Report to Project Detail Page in Project Server 1. Navigate to a PDP (Project Detail Page) , e.g. Schedule PDP. 2. Edit Page 3. Click “Add a Web Part”.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/create-a-timeline-view-for-milestones-in-ssrs-comments/" class="link black dim">
        Create a TimeLine View for Milestones and Project Duration using Matrix in SSRS
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Julia - Jul 4, 2017
Is it possible to insert a Linebreak after each Milestone? So if you have a bunch of Milestones that you can read it more easily.
It&rsquo;s quit easy to add a Linebreak in Tooltipp. Just edited the Statement as below: ,(STUFF( ( SELECT &rsquo; &rsquo; + convert(nvarchar(3), day(TaskFinishDate)) + &rsquo; &rsquo; + + convert(char(3), TaskFinishDate , 0) + &rsquo; &rsquo; + + convert(nvarchar(6), year(TaskFinishDate)) + &rsquo; - &rsquo; + T.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/create-a-timeline-view-for-milestones-in-ssrs/" class="link black dim">
        Create a TimeLine View for Milestones and Project Duration using Matrix in SSRS
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      A range chart in SSRS can be used to produce a Gantt chart.of project. Below is a link to a great post that explains how to do it. http://pnarayanaswamy.blogspot.co.uk/2010/09/range-bar-chart-gantt-chart-using-ssrs.html Unfortunately I have found the following limitations
The width and height of the range chart does not grow dynamically when run. If too much data is displayed, the chart is unreadable To counteract the above limitations, I have used the matrix control which can grow dynamically in terms of width and height to fit the data which remains readable.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-get-financial-year-april-to-march/" class="link black dim">
        SQL Get Financial Year (April to March)
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      The following query will return the financial year starting April to March YEAR(DATEADD(Month,-((DATEPART(Month,StartDate)+8) %12),StartDate)) SELECT YEAR(DATEADD(Month,-((DATEPART(Month,&lsquo;2014-03-31&rsquo;)+8) %12),&lsquo;2014-03-31&rsquo;)) SELECT YEAR(DATEADD(Month,-((DATEPART(Month,&lsquo;2014-04-01&rsquo;)+8) %12),&lsquo;2014-04-01&rsquo;)) SELECT YEAR(DATEADD(Month,-((DATEPART(Month,&lsquo;2014-12-31&rsquo;)+8) %12),&lsquo;2014-12-31&rsquo;)) SELECT YEAR(DATEADD(Month,-((DATEPART(Month,&lsquo;2015-03-31&rsquo;)+8) %12),&lsquo;2015-03-31&rsquo;)) SELECT YEAR(DATEADD(Month,-((DATEPART(Month,&lsquo;2015-04-01&rsquo;)+8) %12),&lsquo;2015-04-01&rsquo;)) The results are 
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/passing-date-parameter-to-subreport-ssrs-sharepoint-integrated-mode/" class="link black dim">
        Passing Date Parameter To SubReport SSRS SharePoint Integrated Mode
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      When SSRS is rendered in SharePoint Integrated Mode if there is a drop down parameter of type DateTime and it is passed to a parameter of DateTime in the SubReport, the subreport fails to load when rendering in browser though it loads correctly from reportbuilder. Again much pain, I decided to convert the date parameters into Text as the parameters were drop down displaying in dd/MM/yyyy format. The SQL query to populate the parameter SELECT CONVERT(nvarchar(10),Min(TimeByDay),103) DisplayDate ,Convert(date,Min(TimeByDay)) StartTime ,CONVERT(VARCHAR(10), Min(TimeByDay), 112) FormatStartTime FROM [dbo].
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-apply-statement-to-break-down-cost-data-evenly-using-date-range/" class="link black dim">
        SQL Apply statement to break down cost data evenly using date range
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Refer to my previous post http://wp.me/p54RZl-3e for more information how to return a list of months using function dbo.FN_Utility_GetMonths. Consider the following script DECLARE @MonthCost table (item_id int,StartDate DateTime,EndDate DateTime, Cost decimal(25,6)) insert into @MonthCost values (1,'2015-01-01','2015-4-01',1000) insert into @MonthCost values (2,'2015-01-01','2015-6-01',1000) insert into @MonthCost values (3,'2015-04-01','2015-06-01',1000) select M.MonthYear MonthYear ,M.StartDate StartDate ,MC.item_Id , Mc.Cost / (datediff(month,MC.StartDate,MC.EndDate)+1) Cost from @MonthCost MC &ndash;iterate through each row to get month cost CROSS APPLY dbo.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-with-statement-to-return-list-of-months-with-date-range/" class="link black dim">
        SQL With statement to return list of Months with date range
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-function-to-return-iso-week-and-iso-year-project-server/" class="link black dim">
        SQL Function to return ISO Week and ISO Year Project Server
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      The table MSP_TimeByDay in the reporting database for on premise Project Server stores date information in day, week, year, quarter , etc.. Unfortunately the columns TimeWeekOfTheYear and TimeYear does not store ISO week and year. The following function returns the ISO week and ISO Year of the date passed. CREATE FUNCTION [dbo].[FN_UTILITY_ConvertToWeekDate] ( @Date datetime ) RETURNS nvarchar(255) AS BEGIN DECLARE @output nvarchar(255) SET @output = (SELECT RIGHT('00' + CAST(Q.ISOweek AS NVARCHAR(2)), 2) + '-' + CAST(CASE WHEN MONTH(@Date) = 1 AND Q.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/sql-function-to-abbreviate-a-set-of-words/" class="link black dim">
        SQL function to abbreviate a set of words
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      The SQL Function script below will abbreviate a set of words using space as delimiter between the words up to number of letters specified CREATE FUNCTION [dbo].FN_UTILITY_GetAbbreviation ( -- Add the parameters for the function here @string NVARCHAR(max), @delimiter NVARCHAR(2) = ' ',-- default delimiter to space @intNum int = 5 --default max number characters to be returned to 5, can change it to number of words passed ) RETURNS NVARCHAR(512) AS BEGIN -- Declare the return variable here DECLARE @output NVARCHAR(512) DECLARE @abbr NVARCHAR(512) &ndash; Add the T-SQL statements to compute the return value here DECLARE @level INT SET @level = 0 DECLARE @lastDotPosition INT SET @lastDotPosition = 0 DECLARE @nextDotPosition INT SET @output = @string SET @abbr = &rsquo;&rsquo; &ndash;depends on number of string let&rsquo;s say up to 5 WHILE(@level 0 THEN CHARINDEX(@delimiter, @string, @lastDotPosition+1) ELSE LEN(@string)+1 END SET @output = SUBSTRING(@string, @lastDotPosition, @nextDotPosition-@lastDotPosition) &ndash;substring(@string, @lastDotPosition, charindex(&rsquo;.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/ssrs-export-to-pdf-results-in-sentence-to-be-concatenated-into-one-long-word/" class="link black dim">
        SSRS Export to PDF results in sentence to be concatenated into one long word
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Sometimes invalid ASCII code invisible to naked eye are stored in the SQL database. If the value with the invalid ASCII is displayed in a SSRS report and exported to PDF, the set of words become concatenated into one word Example &ldquo;The director of the company has given approval&rdquo; displayed in a textbox in SSRS become &ldquo;Thedirectorofthecompanyhasgivenapproval&rdquo; in PDF. The first character of the text value was ASCII code 63. Unfortunately there are other characters that are mapped to 63.
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/get-week-number-based-on-start-date-of-financial-year-april/" class="link black dim">
        Get week number based on start date of financial year - April
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate &lt; @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo].
    </div>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">m365 blog</span>
    <h1 class="f3 near-black">
      <a href="/eomonth-function-in-sql/" class="link black dim">
        EOMONTH Function in SQL
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      EOMONTH returns the last day of the month that is the indicated number of months before or after start_date. Syntax SELECT EOMONTH(start_date, months) The EOMONTH function syntax has the following arguments: 1. Start_date: Required argument. A date that represents the starting date. 2. Months: Optional argument. The number of months before or after start_date. A positive value for months returns a future date; a negative value returns a past date. Please note that if months is not an integer, it is truncated.
    </div>
  </div>
</div>

        </div>
      
    </section>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://famous-cajeta-4dad83.netlify.app/" >
    &copy;  m365 blog 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
