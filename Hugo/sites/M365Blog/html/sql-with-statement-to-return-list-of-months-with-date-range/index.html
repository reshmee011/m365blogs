<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>SQL With statement to return list of Months with date range | m365 blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) &#43; &lsquo;-&rsquo; &#43; RIGHT(0&#43;YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp.">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
      <link href="/sql-with-statement-to-return-list-of-months-with-date-range/index.xml" rel="alternate" type="application/rss+xml" title="m365 blog" />
      <link href="/sql-with-statement-to-return-list-of-months-with-date-range/index.xml" rel="feed" type="application/rss+xml" title="m365 blog" />
      
    
    
    <meta property="og:title" content="SQL With statement to return list of Months with date range" />
<meta property="og:description" content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) &#43; &lsquo;-&rsquo; &#43; RIGHT(0&#43;YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/sql-with-statement-to-return-list-of-months-with-date-range/" /><meta property="article:section" content="" />
<meta property="article:published_time" content="2015-11-20T14:55:44+00:00" />
<meta property="article:modified_time" content="2015-11-20T14:55:44+00:00" />
<meta itemprop="name" content="SQL With statement to return list of Months with date range">
<meta itemprop="description" content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) &#43; &lsquo;-&rsquo; &#43; RIGHT(0&#43;YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp."><meta itemprop="datePublished" content="2015-11-20T14:55:44+00:00" />
<meta itemprop="dateModified" content="2015-11-20T14:55:44+00:00" />
<meta itemprop="wordCount" content="152">
<meta itemprop="keywords" content="SQL,SQL With," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SQL With statement to return list of Months with date range"/>
<meta name="twitter:description" content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) &#43; &lsquo;-&rsquo; &#43; RIGHT(0&#43;YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        m365 blog
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>


    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <h1 class="f1">
          SQL With statement to return list of Months with date range
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links mid-gray">
        <p>With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below <a href="https://msdn.microsoft.com/en-GB/library/ms175972.aspx">https://msdn.microsoft.com/en-GB/library/ms175972.aspx</a> I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details <a href="http://wp.me/p54RZl-3g">http://wp.me/p54RZl-3g</a></p>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://famous-cajeta-4dad83.netlify.app/" >
    &copy;  m365 blog 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
