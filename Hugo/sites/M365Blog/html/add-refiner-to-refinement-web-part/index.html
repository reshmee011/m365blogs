<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Add Refiner to Refinement Web Part using CSOM and PowerShell | m365 blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part.">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
      <link href="/add-refiner-to-refinement-web-part/index.xml" rel="alternate" type="application/rss+xml" title="m365 blog" />
      <link href="/add-refiner-to-refinement-web-part/index.xml" rel="feed" type="application/rss+xml" title="m365 blog" />
      
    
    
    <meta property="og:title" content="Add Refiner to Refinement Web Part using CSOM and PowerShell" />
<meta property="og:description" content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/add-refiner-to-refinement-web-part/" /><meta property="article:section" content="" />
<meta property="article:published_time" content="2016-10-05T06:06:13+00:00" />
<meta property="article:modified_time" content="2016-10-05T06:06:13+00:00" />
<meta itemprop="name" content="Add Refiner to Refinement Web Part using CSOM and PowerShell">
<meta itemprop="description" content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part."><meta itemprop="datePublished" content="2016-10-05T06:06:13+00:00" />
<meta itemprop="dateModified" content="2016-10-05T06:06:13+00:00" />
<meta itemprop="wordCount" content="227">
<meta itemprop="keywords" content="CSOM,Managed Properties,PowerShell,Refinement Web Part,Refiners,Search,SharePoint 2013,SharePoint Online," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Add Refiner to Refinement Web Part using CSOM and PowerShell"/>
<meta name="twitter:description" content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        m365 blog
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>


    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <h1 class="f1">
          Add Refiner to Refinement Web Part using CSOM and PowerShell
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links mid-gray">
        <p>The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are</p>
<ol>
<li>Search Box Web Part</li>
<li>Search Navigation</li>
<li>Search Results</li>
<li>Refinement Web Part</li>
</ol>
<p>The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part. <img src="https://reshmeeauckloo.files.wordpress.com/2016/10/newrefineraddedtowebpart.png" alt="newrefineraddedtowebpart"> By default, the refiners FileType, contentclass, contentTypeId, WebTemplate, DisplayAuthor and LastModifiedTime are available to select. The XML definition of the webpart is <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->Cannot import this Web Part.<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->{}<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->null<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <strong><!-- raw HTML omitted -->{&ldquo;refinerConfigurations&rdquo;:[{&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:21,&ldquo;propertyName&rdquo;:&ldquo;FileType&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;</strong> ** ,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;,&ldquo;displayName&rdquo;:&quot;&quot;,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:[&ldquo;format&rdquo;],&ldquo;refinerSpecStringOverride&rdquo;:&quot;&quot;** ** ,&ldquo;intervals&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;contentclass&rdquo;,&ldquo;displayName&rdquo;:null,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;,&ldquo;maxNumberRefinementOptions&rdquo;:10** ** ,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:[&ldquo;DAV:contentclass&rdquo;]},{&ldquo;propertyName&rdquo;:&ldquo;ContentTypeId&rdquo;** ** ,&ldquo;displayName&rdquo;:null,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;,&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;WebTemplate&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;,&ldquo;maxNumberRefinementOptions&rdquo;:10,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;DisplayAuthor&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;,&ldquo;maxNumberRefinementOptions&rdquo;:9,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;LastModifiedTime&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_SliderBarGraph.js&quot;,&ldquo;maxNumberRefinementOptions&rdquo;:0,&ldquo;type&rdquo;:&ldquo;DateTime&rdquo;** ** ,&ldquo;refinerSpecStringOverride&rdquo;:null,&ldquo;useDefaultDateIntervals&rdquo;:true,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:[&ldquo;Write&rdquo;,&ldquo;FileWrite&rdquo;,&ldquo;DAV:getlastmodified&rdquo;]},{&ldquo;sortBy&rdquo;:0** ** ,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;propertyName&rdquo;:&ldquo;RefinableString00&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;** ** ,&ldquo;displayName&rdquo;:&ldquo;Directorate&rdquo;,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:null,&ldquo;refinerSpecStringOverride&rdquo;:&quot;&quot;,&ldquo;intervals&rdquo;:null},{&ldquo;sortBy&rdquo;:0** ** ,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;propertyName&rdquo;:&ldquo;RefinableString01&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;displayTemplate&rdquo;:&quot;~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js&quot;** ** ,&ldquo;displayName&rdquo;:&ldquo;Status&rdquo;,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:null,&ldquo;refinerSpecStringOverride&rdquo;:&quot;&quot;,&ldquo;intervals&rdquo;:null}****]}<!-- raw HTML omitted -->** <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->~sitecollection/_catalogs/masterpage/Display Templates/Filters/Control_Refinement.js<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->All<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->This webpart helps the users to refine search results<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->None<!-- raw HTML omitted --> <!-- raw HTML omitted -->Normal<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->Modeless<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted -->False<!-- raw HTML omitted --> <!-- raw HTML omitted -->Refinement<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->Cannot import this Web Part.<!-- raw HTML omitted --> <!-- raw HTML omitted -->False<!-- raw HTML omitted --> <!-- raw HTML omitted -->Default<!-- raw HTML omitted --> <!-- raw HTML omitted -->True<!-- raw HTML omitted --> <!-- raw HTML omitted -->NotSet<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> To modify the collection of refiners the property &ldquo;SelectedRefinementControlsJson&rdquo; which is in Json format needs to be updated. The property &ldquo;SelectedRefinementControlsJson&rdquo; is converted to JSON using PowerShell ConvertFrom-Json method before additional refiners are added. The PowerShell ConvertTo-Json method is used to convert back to JSON before updating the &ldquo;SelectedRefinementControlsJson&rdquo; property. <a href="https://gist.github.com/reshmee011/352aa388e1a8d9641cca28fffb8b6221">https://gist.github.com/reshmee011/352aa388e1a8d9641cca28fffb8b6221</a></p>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://famous-cajeta-4dad83.netlify.app/" >
    &copy;  m365 blog 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
