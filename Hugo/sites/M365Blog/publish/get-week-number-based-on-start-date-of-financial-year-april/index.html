<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Get week number based on start date of financial year - April | Reshmee blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate < @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo]."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/get-week-number-based-on-start-date-of-financial-year-april/index.xml rel=alternate type=application/rss+xml title="Reshmee blog"><link href=/get-week-number-based-on-start-date-of-financial-year-april/index.xml rel=feed type=application/rss+xml title="Reshmee blog"><meta property="og:title" content="Get week number based on start date of financial year - April"><meta property="og:description" content="Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate < @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo]."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/get-week-number-based-on-start-date-of-financial-year-april/"><meta property="article:section" content><meta property="article:published_time" content="2015-10-27T12:37:43+00:00"><meta property="article:modified_time" content="2015-10-27T12:37:43+00:00"><meta itemprop=name content="Get week number based on start date of financial year - April"><meta itemprop=description content="Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate < @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo]."><meta itemprop=datePublished content="2015-10-27T12:37:43+00:00"><meta itemprop=dateModified content="2015-10-27T12:37:43+00:00"><meta itemprop=wordCount content="195"><meta itemprop=keywords content="SQL,SQL SSRS,SSRS,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Get week number based on start date of financial year - April"><meta name=twitter:description content="Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate < @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo]."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><div class="flex-l mt2 mw8 center"><article class="center cf pv5 ph3 ph4-ns mw7"><header><h1 class=f1>Get week number based on start date of financial year - April</h1></header><div class="nested-copy-line-height lh-copy f4 nested-links mid-gray"><p>Most organisations start their financial year in April in UK. The requirement is to set first week in April to 1. I have found the script from blog which creates a function which fulfills the objective above. See more at: <a href=http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf>http://www.sqlteam.com/article/returning-a-week-number-for-any-given-date-and-starting-fiscal-month#sthash.vegLomU6.dpuf</a> <code>CREATE FUNCTION GetFiscalWeek (@startMonth varchar(2), @myDate datetime) RETURNS INT AS BEGIN declare @firstWeek datetime declare @weekNum int declare @year int set @year = datepart(year, @myDate)+1 --Get 4th day of month of next year, this will always be in week 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) --Retreat to beginning of week set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) WHILE @myDate &lt; @firstWeek --Repeat the above steps but for previous year BEGIN set @year = @year - 1 set @firstWeek = convert(datetime, str(@year)+@startMonth+'04', 102) set @firstWeek = dateadd(day, (1-datepart(dw, @firstWeek)), @firstWeek) END SET @weekNum = (@year*100)+((datediff(day, @firstweek, @myDate)/7)+1) RETURN @weekNum END</code> Examples of using the function Use SET DATEFIRST 1 to set the first day of the week to be Monday SET DATEFIRST 1 Select [dbo].GetFiscalWeek(&lsquo;04&rsquo;, &lsquo;2015-04-01&rsquo;) - returns 201501 SET DATEFIRST 1 Select [dbo].GetFiscalWeek(&lsquo;04&rsquo;, &lsquo;2015-06-01&rsquo;) - returns 201510 SET DATEFIRST 1 Select [dbo].GetFiscalWeek(&lsquo;04&rsquo;, &lsquo;2015-03-31&rsquo;) -returns 201501 SET DATEFIRST 1 Select [dbo].GetFiscalWeek(&lsquo;04&rsquo;, &lsquo;2015-03-29&rsquo;) -returns 201452</p></div></article></div></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee blog 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>