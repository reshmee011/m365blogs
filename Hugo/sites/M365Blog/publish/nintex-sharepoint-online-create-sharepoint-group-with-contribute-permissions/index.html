<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Nintex SharePoint Online Create SharePoint Group with Contribute permissions | Reshmee blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Nintex Workflow has actions &ldquo;Web Request&rdquo; and &ldquo;Call HTTP Web Service&rdquo; which can be used to make calls to the REST API of SharePoint Online/2013 to automate creation of SharePoint groups in a site collection. Add the following steps to the workflow
Create a Text variable GroupName and Use &ldquo;Set Workflow Variable&rdquo; to assign it to a value. Get request digest from targeted site collection. Please note that workflow app permissions need to amended to give site collection full control access."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/nintex-sharepoint-online-create-sharepoint-group-with-contribute-permissions/index.xml rel=alternate type=application/rss+xml title="Reshmee blog"><link href=/nintex-sharepoint-online-create-sharepoint-group-with-contribute-permissions/index.xml rel=feed type=application/rss+xml title="Reshmee blog"><meta property="og:title" content="Nintex SharePoint Online Create SharePoint Group with Contribute permissions"><meta property="og:description" content="Nintex Workflow has actions &ldquo;Web Request&rdquo; and &ldquo;Call HTTP Web Service&rdquo; which can be used to make calls to the REST API of SharePoint Online/2013 to automate creation of SharePoint groups in a site collection. Add the following steps to the workflow
Create a Text variable GroupName and Use &ldquo;Set Workflow Variable&rdquo; to assign it to a value. Get request digest from targeted site collection. Please note that workflow app permissions need to amended to give site collection full control access."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/nintex-sharepoint-online-create-sharepoint-group-with-contribute-permissions/"><meta property="article:section" content><meta property="article:published_time" content="2016-05-03T14:53:03+00:00"><meta property="article:modified_time" content="2016-05-03T14:53:03+00:00"><meta itemprop=name content="Nintex SharePoint Online Create SharePoint Group with Contribute permissions"><meta itemprop=description content="Nintex Workflow has actions &ldquo;Web Request&rdquo; and &ldquo;Call HTTP Web Service&rdquo; which can be used to make calls to the REST API of SharePoint Online/2013 to automate creation of SharePoint groups in a site collection. Add the following steps to the workflow
Create a Text variable GroupName and Use &ldquo;Set Workflow Variable&rdquo; to assign it to a value. Get request digest from targeted site collection. Please note that workflow app permissions need to amended to give site collection full control access."><meta itemprop=datePublished content="2016-05-03T14:53:03+00:00"><meta itemprop=dateModified content="2016-05-03T14:53:03+00:00"><meta itemprop=wordCount content="619"><meta itemprop=keywords content="Nintex,REST,REST POST Nintex SharePoint Online,SharePoint,SharePoint 2013,SharePoint Online,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nintex SharePoint Online Create SharePoint Group with Contribute permissions"><meta name=twitter:description content="Nintex Workflow has actions &ldquo;Web Request&rdquo; and &ldquo;Call HTTP Web Service&rdquo; which can be used to make calls to the REST API of SharePoint Online/2013 to automate creation of SharePoint groups in a site collection. Add the following steps to the workflow
Create a Text variable GroupName and Use &ldquo;Set Workflow Variable&rdquo; to assign it to a value. Get request digest from targeted site collection. Please note that workflow app permissions need to amended to give site collection full control access."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><div class="flex-l mt2 mw8 center"><article class="center cf pv5 ph3 ph4-ns mw7"><header><h1 class=f1>Nintex SharePoint Online Create SharePoint Group with Contribute permissions</h1></header><div class="nested-copy-line-height lh-copy f4 nested-links mid-gray"><p>Nintex Workflow has actions &ldquo;Web Request&rdquo; and &ldquo;Call HTTP Web Service&rdquo; which can be used to make calls to the REST API of SharePoint Online/2013 to automate creation of SharePoint groups in a site collection. Add the following steps to the workflow</p><ol><li>Create a Text variable GroupName and Use &ldquo;Set Workflow Variable&rdquo; to assign it to a value.<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/groupnamevariable.png alt=GroupNameVariable></li><li>Get request digest from targeted site collection. Please note that workflow app permissions need to amended to give site collection full control access.        <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/app-step-to-get-request-digest.png alt="App Step to get request digest"><ul><li>Add &ldquo;App Step&rdquo; action</li><li>Add &ldquo;Web Request&rdquo; action. Fill in the following fields<ul><li><p>URL: /_api/ContextInfo</p></li><li><p>Method : POST</p></li><li><p>Content type : application/x-www-form-urlencoded</p></li><li><p>Header Name (Key) : Accept     Header value: application/json;odata=verbose</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2016/04/webrequesttogetrequestdigest.png alt=WebRequestToGetRequestDigest></p></li><li><p>Body : Choose &ldquo;Content&rdquo; option  and enter &ldquo;{}&rdquo; in text field</p></li><li><p>UserName: Credentials who has access to targeted site</p></li><li><p>Password: password of above UserName</p></li><li><p>Store response content in : Create a variable &ldquo;digest token&rdquo;<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/webrequesttogetrequestdigest_2.png alt=WebRequestToGetRequestDigest_2></p></li></ul></li><li>Add &ldquo;Query XML&rdquo; action. Fill in the following fields<ul><li><p>XML source: Choose &ldquo;Content&rdquo; and pick variable &ldquo;digest token&rdquo;</p></li><li><p>XPath query: /d:GetContextWebInformation/d:FormDigestValue</p></li><li><p>Return result as :Text</p></li><li><p>Query result in : create a text variable strDigestInfo<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/queryxmlrequestdigest.png alt=QueryXMLRequestDigest></p></li></ul></li><li>Add &ldquo;Log to History&rdquo; action. Print the strDigestInfo to make sure valid request digest are used  <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/queryxmlrequestdigest.png alt=QueryXMLRequestDigest></li></ul></li><li>Create SharePoint Group using REST API ‍/_api/web/sitegroups  <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/appsteptocreatespgroup.png alt=AppStepToCreateSpGroup><ul><li>Add &ldquo;App Step&rdquo; action. Optionally add &ldquo;Log to History List&rdquo; action to log status of workflow.</li><li>Add &ldquo;Build Dictionary&rdquo; action to build &ldquo;Request Headers&rdquo;.<ul><li> Add the following key value pair as Text- content-type:  application/json; odata=verbose - X-RequestDigest : {Variable:strDigestInfo}</li><li>Save Output into RequestHeaders<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/requestheaders.png alt=RequestHeaders></li></ul></li><li>Add &ldquo;Build Dictionary&rdquo; action to build &ldquo;Metadata&rdquo;<ul><li> Add the following key/value pair- key: type    Type:Text  Value: SP.Group <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/buildmetadataforgroup.png alt=BuildMetadataForGroup></li></ul></li><li>Add &ldquo;Build Dictionary&rdquo; action to build &ldquo;Parameters&rdquo;<ul><li> Add the following key/value pair- Key: __metadata   Type:Dictionary   Value: Workflow Variable GroupMetadata - Key: Description  Type: Text  Value: Group created automatically from Nintex workflow - Key: Title  Type:Text  Value:{Variable:GroupName}</li><li>Assign Output to a dictionary variable GroupParameters <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/builddictionarygroupparameters.png alt=BuildDictionaryGroupParameters></li></ul></li><li>Add &ldquo;HTTP Web Service"action to create group<ul><li>Fill in Address : /_api/web/sitegroups</li><li>Set Request Type to &ldquo;HTTP Post&rdquo;</li><li>Set Request Headers to dictionary variable RequestHeaders</li><li>Set Request Content to dictionary variable GroupParameters</li><li>Set Response Headers to new dictionary variable GroupResponseHeaders</li><li>Set Response Content to new dictionary variable GroupResponseContent</li><li>Set Response Status Code to new text variable GroupResponseStatusCode<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/webrequesttocreategroup1.png alt=WebRequestToCreateGroup></li></ul></li><li>Log to History list the response<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/logresponseofgroupcreated.png alt=LogResponseOfGroupCreated></li></ul></li><li>Retrieve SharePoint Group using REST API ‍ ‍/_api/web/sitegroups/getbyname <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/appsteptogetgroupcreated.png alt=AppStepToGetGroupCreated><ul><li>Add &ldquo;Add Step&rdquo; action</li><li>Optionally add &ldquo;Log History List&rdquo; action to log workflow status.</li><li>Add a &ldquo;Web Request&rdquo; action<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/webrequesttogetgroupcreated.png alt=WebRequestToGetGroupCreated><ul><li>Set URL to /_api/web/sitegroups/getbyname(&lsquo;‍<a href="https://wus-des-wfo.nintex.com//href=%22#%22">{Variable:GroupName}</a>‍&rsquo;)?$select=Id</li><li>Choose  Get for Method</li><li>Click Add Header</li><li>Set Header Key to &ldquo;Accept&rdquo;</li><li>Set Header Value to &ldquo;application/json;odata=verbose&rdquo;</li><li>Set UserName to user who has access to site collection</li><li>Set Password to password of specified user</li><li>Set Store response content in a Text variable GroupRequestIDXMLAdd</li></ul></li><li>Add &ldquo;Log History List&rdquo; action to log response GroupRequestIDXMLAdd from web request. The response is in JSON format. Nintex does not have a JSON parser action to retrieve value of property. Use &ldquo;Regular Expression&rdquo; action as described in the next step is used to retrieve Id value</li><li>Add &ldquo;Regular Expression&rdquo; action<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/regularexpressiontogetid.png alt=RegularExpressionToGetID><ul><li>Set String to ‍{Variable:GroupRequestIDXML}</li><li>Set String Operation to Extract</li><li>Set pattern to (?&lt;=&ldquo;Id&rdquo;:).*?(?=})</li><li>Save Output to text variable strGroupIDCol</li></ul></li><li>Add &ldquo;Get Item from Collection&rdquo; action.<img src=https://reshmeeauckloo.files.wordpress.com/2016/04/getgroupidfromcollection.png alt=GetGroupIDFromCollection><ul><li>Set Target Collection to variable strGroupIDCol</li><li>Set Index to 0</li><li>Set Output to SPGroupId</li></ul></li><li> Add &ldquo;Log History List&rdquo; action to log strGroupIDCol</li></ul></li><li>Add Contribute Role to new Group<ul><li>Add App Step action  <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/appsteptoaddcontributeroletogroup2.png alt=AppStepToAddContributeRoleToGroup></li><li>Add &ldquo;Call HTTP Web Service&rdquo; Action <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/webrequesttoaddcontributerole.png alt=WebRequestToAddContributeRole><ul><li>Set URL to ‍/_api/web/roleassignments/addroleassignment(principalid=‍<a href="https://wus-des-wfo.nintex.com//href=%22#%22">{Variable:SPGroupId}</a>‍,roleDefId=1073741827)</li><li>Set Request Type to &ldquo;HTTP Post&rdquo;</li><li>Set Request Headers to dictionary &ldquo;RequestHeaders&rdquo;</li><li>Set Response Headers to new dictionary variable RoleAssignResponseHeaders</li><li>Set Response Content to new dictionary variable RoleAssignmResponseContent</li><li>Set Response Status Code to new text variable RoleAssignmResponseStatusCode</li></ul></li><li>Add &ldquo;Log to History List&rdquo; action to log response of web request</li></ul></li></ol><p>Save and Publish the workflow. If the workflow runs succesfully <img src=https://reshmeeauckloo.files.wordpress.com/2016/04/workflowhistory.png alt=WorkflowHistory></p></div></article></div></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee blog 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>