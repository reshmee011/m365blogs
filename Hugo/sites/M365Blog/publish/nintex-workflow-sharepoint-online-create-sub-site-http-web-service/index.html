<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action | Reshmee blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/nintex-workflow-sharepoint-online-create-sub-site-http-web-service/index.xml rel=alternate type=application/rss+xml title="Reshmee blog"><link href=/nintex-workflow-sharepoint-online-create-sub-site-http-web-service/index.xml rel=feed type=application/rss+xml title="Reshmee blog"><meta property="og:title" content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta property="og:description" content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/nintex-workflow-sharepoint-online-create-sub-site-http-web-service/"><meta property="article:section" content><meta property="article:published_time" content="2015-11-28T22:36:21+00:00"><meta property="article:modified_time" content="2015-11-28T22:36:21+00:00"><meta itemprop=name content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta itemprop=description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta itemprop=datePublished content="2015-11-28T22:36:21+00:00"><meta itemprop=dateModified content="2015-11-28T22:36:21+00:00"><meta itemprop=wordCount content="511"><meta itemprop=keywords content="Nintex,Nintex Workflow,SharePoint Online,Uncategorized,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta name=twitter:description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><div class="flex-l mt2 mw8 center"><article class="center cf pv5 ph3 ph4-ns mw7"><header><h1 class=f1>Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action</h1></header><div class="nested-copy-line-height lh-copy f4 nested-links mid-gray"><p>In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to <a href="https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx">https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx</a> for more info)</p><ol><li>Allow workflow to use app permissions</li></ol><p> a. Navigate to site settings</p><p> b. Under Site Actions, click Manage site features</p><p>c. Locate the Workflows can app permissions and click Activate if it is not activated yet.</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/workflowcan-use-app-permissions.jpg alt="WorkflowCan use app permissions">2. Allow workflow to use app permissions</p><p>3.Navigate to site settings> site app permissions</p><p><a href=https://reshmeeauckloo.files.wordpress.com/2015/11/site-app-permissions.jpg><img src="https://reshmeeauckloo.files.wordpress.com/2015/11/site-app-permissions.jpg?w=300" alt="Site App Permissions"></a> Note down the workflow app id which is between i:0i.t|ms.sp.ext| and @</p><p>4. Navigate to /_layouts/15/appinv.aspx</p><p>5. Enter workflow app id  and click on Lookup button 6. Enter the following in Permission Request XML</p><p>&lt;AppPermissionRequest Scope="<a href=http://sharepoint/content/sitecollection title=http://sharepoint/content/sitecollection>http://sharepoint/content/sitecollection</a>" Right=&ldquo;FullControl&rdquo; />     <a href=https://reshmeeauckloo.files.wordpress.com/2015/11/grantpermissions.jpg><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/grantpermissions.jpg alt=GrantPermissions></a></p><p>7.Click on Create 8.Click on Trust the app.</p><p>The logic of the Nintex Workflow was built using the <a href=http://blog.vgrem.com/2014/05/08/consuming-the-sharepoint-2013-rest-service-from-sharepoint-designer/>Consuming the SharePoint 2013 REST Service from SharePoint Designer</a> that describes how to configure Call HTTP Web Service Action in order to create web site. Create a new Nintex Workflow against a custom list with Title column only using the Nintex Workflow Designer</p><ol><li>Use &ldquo;Set Workflow Variable&rdquo; action to create and assign variable RequestURL /_api/web/webinfos/add</li></ol><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/1-set-workflow-variable-requesturl1.jpg alt="1.Set Workflow Variable RequestURL"></p><p>2. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign Title</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/4-set-workflow-variable-title1.jpg alt="4.Set Workflow Variable Title"></p><p>3. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign SiteURL the expected URL</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/3-set-workflow-variable-siteurl1.jpg alt="3.Set Workflow Variable SiteUrl"></p><p>4. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign variable SiteTemplate</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/2-set-workflow-variable-site-template.jpg alt="2.Set Workflow Variable Site Template"></p><p>5. Use action &ldquo;Build Dictionary&rdquo; to build Dictionary RequestHeaders.</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/5-build-dictionary-requestheader.jpg alt="5.Build Dictionary RequestHeader"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> Accept</p><p>Text</p><p> application/json;odata=verbose</p><p> Content-Type</p><p>Text</p><p> application/json;odata=verbose</p><p>Table 1. Request Headers for a RequestHeaders dictionary variable 6. Use action &ldquo;Build Dictionary&rdquo; to build Dictionary MetaData.<img src=https://reshmeeauckloo.files.wordpress.com/2015/11/6-build-dictionary-metadata.jpg alt="6.Build Dictionary Metadata"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> type</p><p>Text</p><p> SP.WebInfoCreationInformation</p><p>Table 2.  Metadata dictionary variable 7. Use action &ldquo;Build Dictionary&rdquo; to  build Dictionary Parameters. <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/7-build-dictionary-parameters.jpg alt="7.Build Dictionary Parameters"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> __metadata</p><p>Dictionary</p><p>Workflow Variable:Metadata</p><p> Url</p><p>Text</p><p>Workflow Variable:Title</p><p> Title</p><p>Text</p><p>Workflow Variable:Title</p><p> Description</p><p>Text</p><p>Workflow Variable:Title</p><p> Language</p><p>Text</p><p> Value:1033</p><p> WebTemplate</p><p>Text</p><p> Workflow Variable: sts</p><p> UseIniquePermissions</p><p> Boolean</p><p> Value:No</p><p>Table 3.  Parameters dictionary variable 8. Create App Step <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/9-1app-step.jpg alt="9.1App Step"> 9. Add and Configure the HTTP Web Service <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/9-call-http-web-service.jpg alt="9.Call HTTP Web Service"></p><p>Property Name</p><p>Value</p><p> Address</p><p>Set value to variable RequestUrl that was created in step 1</p><p> RequestType</p><p>Set value to HTTP POST</p><p> RequestHeaders</p><p>Set value to dictionary variable RequestHeaders that we’ve constructed to store request header properties in step 5</p><p> ResponseContent</p><p>Create a new dictionary variable named ResponseContent to store the body of this HTTP request</p><p>ResponseHeaders</p><p>Create a new dictionary variable ResponseHeaders to store the response headers of this HTTP request.</p><p>ResponseStatusCode</p><p>Create a new text variable named ResponseStatusCode  to store the response status code of this HTTP request.</p><p>Table 4. HTTP Web Service Action configuration Publish the workflow against the list and run workflow against an item in the list to create a subsite with the title specified. <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/workflow.jpg alt=Workflow></p></div></article></div></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee blog 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>