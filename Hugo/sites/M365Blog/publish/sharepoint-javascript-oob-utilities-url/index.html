<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>SharePoint JavaScript OOB Utilities URL | Reshmee blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/sharepoint-javascript-oob-utilities-url/index.xml rel=alternate type=application/rss+xml title="Reshmee blog"><link href=/sharepoint-javascript-oob-utilities-url/index.xml rel=feed type=application/rss+xml title="Reshmee blog"><meta property="og:title" content="SharePoint JavaScript OOB Utilities URL"><meta property="og:description" content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/sharepoint-javascript-oob-utilities-url/"><meta property="article:section" content><meta property="article:published_time" content="2015-12-17T22:17:12+00:00"><meta property="article:modified_time" content="2015-12-17T22:17:12+00:00"><meta itemprop=name content="SharePoint JavaScript OOB Utilities URL"><meta itemprop=description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta itemprop=datePublished content="2015-12-17T22:17:12+00:00"><meta itemprop=dateModified content="2015-12-17T22:17:12+00:00"><meta itemprop=wordCount content="363"><meta itemprop=keywords content="AddKeyValueQueryString,GetUrlKeyValue,IndexOfIllegalCharInUrlPath,JavaScript,ReplaceUrlTokens,SetUrlKeyValue,SharePoint,SharePoint 2013,Uncategorized,URL Utilities,"><meta name=twitter:card content="summary"><meta name=twitter:title content="SharePoint JavaScript OOB Utilities URL"><meta name=twitter:description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><div class="flex-l mt2 mw8 center"><article class="center cf pv5 ph3 ph4-ns mw7"><header><h1 class=f1>SharePoint JavaScript OOB Utilities URL</h1></header><div class="nested-copy-line-height lh-copy f4 nested-links mid-gray"><p>SharePoint provides Out of Box JavaScript libraries to manipulate URL property. <strong>GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive)</strong> Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive <strong>SetUrlKeyValue(keyName, keyValue, bEncode, url)</strong> Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters. &ldquo;http://&rdquo;, question mark, hash, ssemicolon and ampersand have to be stripped before passing to these functions otherwise they will be interpreted as illegal characters. //check URL <strong>IndexOfIllegalCharInUrlPath(string)</strong> //check file name <strong>IndexOfIllegalCharInUrlLeafName(string)</strong> An example of the use of the functions are below <code>var currentUrl = _spPageContextInfo.webAbsoluteUrl.replace("http://", "") + _spPageContextInfo.serverRequestPath;</code> var illChar = IndexOfIllegalCharInUrlPath(currentUrl); <img src=https://reshmeeauckloo.files.wordpress.com/2015/12/indexillegalchar.jpg alt=indexIllegalChar.JPG> <strong>ReplaceUrlTokens(urlWithTokens,ctx)</strong> Allows to replace all instances of one of six SP specific tokens in a URL {ItemId} {ItemUrl} {SiteUrl} {ListId} {Source} {ListUrlDir} The code below uses the function to obtain listId , SiteUrl and ListUrlDir which is the rootfolder Url of the list. <code>var tokenizedUrl = "http://www.test?list={ListId}&amp;SiteUrl={SiteUrl}&amp;ListDir={ListUrlDir}" var url = ReplaceUrlTokens(tokenizedUrl,ctx); console.log(url) var listId = GetUrlKeyValue ( "List",false, url, true); console.log("ListId:" + listId) var siteUrl = GetUrlKeyValue ( "SiteUrl",false, url, true); console.log("siteUrl" + siteUrl) var ListUrlDir = GetUrlKeyValue ( "ListUrlDir",false, url, true); console.log("ListUrlDir:" + ListUrlDir)</code> <strong>SP.Utilities.UrlBuilder.urlCombine(string1, string2)</strong> Combines the two string parameters without redundant slashes between them. However onlyÂ works if second string does not begin with a slash. <strong>SP.Utilities.UrlBuilder.removeQueryString(url,key)</strong> Removes key value parameter from url. <code>var urllink = "http://test.com?param1=200&amp;param2=900" console.log(SP.Utilities.UrlBuilder.removeQueryString(urlLink,param1));</code> <strong>SP.Utilities.Utility.getLayoutsPageUrl(pageFileName)</strong> Get relative URL for specific layout page for current context It is useful when writing in a mixed 2010, 2013 mode where some sites have been upgraded <code>alert(SP.Utilities.Utility.getLayoutsPageUrl("SiteSettings.aspx"))</code> <strong>SP.Utilities.UrlBuilder.navigateTo(url)</strong> It takes the browser to specified url. It is useful when the page url is loaded into a SP modal dialog then the new page that gets loaded will remain inside that dialog as well. Copy the code into a script editor web part to test. <code>&lt;a onclick="SP.Utilities.UrlBuilder.navigateTo('http://www.google.com')">Navigate in Dialog&lt;/a> &lt;a href='http://www.google.com')">Navigate without Dialog&lt;/a></code> <strong>AddKeyValueQueryString(key,value)</strong> var testUrl = SP.Utilities.Utility.getLayoutsPageUrl(&ldquo;test.aspx&rdquo;) var urlBuilder = SP.Utilities.UrlBuilder(testUrl); urlBuilder.AddKeyValueQueryString(&ldquo;param&rdquo;,&ldquo;112&rdquo;); console.log( urlBuilder.get_url());</p></div></article></div></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee blog 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>