<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Add Refiner to Refinement Web Part using CSOM and PowerShell - m365 blog</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://famous-cajeta-4dad83.netlify.app/add-refiner-to-refinement-web-part/index.xml title="m365 blog"><meta itemprop=name content="Add Refiner to Refinement Web Part using CSOM and PowerShell"><meta itemprop=description content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part."><meta itemprop=datePublished content="2016-10-05T06:06:13+00:00"><meta itemprop=dateModified content="2016-10-05T06:06:13+00:00"><meta itemprop=wordCount content="227"><meta itemprop=keywords content="CSOM,Managed Properties,PowerShell,Refinement Web Part,Refiners,Search,SharePoint 2013,SharePoint Online,"><meta property="og:title" content="Add Refiner to Refinement Web Part using CSOM and PowerShell"><meta property="og:description" content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part."><meta property="og:type" content="article"><meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/add-refiner-to-refinement-web-part/"><meta property="article:section" content><meta property="article:published_time" content="2016-10-05T06:06:13+00:00"><meta property="article:modified_time" content="2016-10-05T06:06:13+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Add Refiner to Refinement Web Part using CSOM and PowerShell"><meta name=twitter:description content="The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are
Search Box Web Part Search Navigation Search Results Refinement Web Part The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part."><link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://famous-cajeta-4dad83.netlify.app/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://famous-cajeta-4dad83.netlify.app/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://famous-cajeta-4dad83.netlify.app/css/dark.css><script src=https://famous-cajeta-4dad83.netlify.app/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://famous-cajeta-4dad83.netlify.app/>m365 blog</a></h1><div class=site-description><nav class="nav social"><ul class=flat></ul></nav></div><nav class=nav><ul class=flat></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>05</span>
<span class=rest>Oct 2016</span></div></div><div class=matter><h1 class=title>Add Refiner to Refinement Web Part using CSOM and PowerShell</h1></div></div><div class=markdown><p>The refinement web part present by default on a search results page help to narrow down search results. The inter connected web parts present in a search result page are</p><ol><li>Search Box Web Part</li><li>Search Navigation</li><li>Search Results</li><li>Refinement Web Part</li></ol><p>The refinement web part used refiners which are managed properties bound to crawled properties created by search crawl. The managed properties must be enabled as refiners to be able to use on the web part. <img src=https://reshmeeauckloo.files.wordpress.com/2016/10/newrefineraddedtowebpart.png alt=newrefineraddedtowebpart> By default, the refiners FileType, contentclass, contentTypeId, WebTemplate, DisplayAuthor and LastModifiedTime are available to select. The XML definition of the webpart is Cannot import this Web Part. {} null <strong>{&ldquo;refinerConfigurations&rdquo;:[{&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:21,&ldquo;propertyName&rdquo;:&ldquo;FileType&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;</strong> ** ,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js",&ldquo;displayName&rdquo;:"",&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:[&ldquo;format&rdquo;],&ldquo;refinerSpecStringOverride&rdquo;:""** ** ,&ldquo;intervals&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;contentclass&rdquo;,&ldquo;displayName&rdquo;:null,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js",&ldquo;maxNumberRefinementOptions&rdquo;:10** ** ,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:[&ldquo;DAV:contentclass&rdquo;]},{&ldquo;propertyName&rdquo;:&ldquo;ContentTypeId&rdquo;** ** ,&ldquo;displayName&rdquo;:null,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js",&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;WebTemplate&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js",&ldquo;maxNumberRefinementOptions&rdquo;:10,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;DisplayAuthor&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js",&ldquo;maxNumberRefinementOptions&rdquo;:9,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;refinerSpecStringOverride&rdquo;:null** ** ,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:null},{&ldquo;propertyName&rdquo;:&ldquo;LastModifiedTime&rdquo;,&ldquo;displayName&rdquo;:null** ** ,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_SliderBarGraph.js",&ldquo;maxNumberRefinementOptions&rdquo;:0,&ldquo;type&rdquo;:&ldquo;DateTime&rdquo;** ** ,&ldquo;refinerSpecStringOverride&rdquo;:null,&ldquo;useDefaultDateIntervals&rdquo;:true,&ldquo;isInherited&rdquo;:false,&ldquo;sortBy&rdquo;:0,&ldquo;sortOrder&rdquo;:0,&ldquo;intervals&rdquo;:null,&ldquo;aliases&rdquo;:[&ldquo;Write&rdquo;,&ldquo;FileWrite&rdquo;,&ldquo;DAV:getlastmodified&rdquo;]},{&ldquo;sortBy&rdquo;:0** ** ,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;propertyName&rdquo;:&ldquo;RefinableString00&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js"** ** ,&ldquo;displayName&rdquo;:&ldquo;Directorate&rdquo;,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:null,&ldquo;refinerSpecStringOverride&rdquo;:"",&ldquo;intervals&rdquo;:null},{&ldquo;sortBy&rdquo;:0** ** ,&ldquo;sortOrder&rdquo;:0,&ldquo;maxNumberRefinementOptions&rdquo;:15,&ldquo;propertyName&rdquo;:&ldquo;RefinableString01&rdquo;,&ldquo;type&rdquo;:&ldquo;Text&rdquo;,&ldquo;displayTemplate&rdquo;:"~sitecollection/_catalogs/masterpage/Display Templates/Filters/Filter_Default.js"** ** ,&ldquo;displayName&rdquo;:&ldquo;Status&rdquo;,&ldquo;useDefaultDateIntervals&rdquo;:false,&ldquo;aliases&rdquo;:null,&ldquo;refinerSpecStringOverride&rdquo;:"",&ldquo;intervals&rdquo;:null}****]}** True ~sitecollection/_catalogs/masterpage/Display Templates/Filters/Control_Refinement.js True All True True This webpart helps the users to refine search results True None Normal Modeless False Refinement True Cannot import this Web Part. False Default True NotSet To modify the collection of refiners the property &ldquo;SelectedRefinementControlsJson&rdquo; which is in Json format needs to be updated. The property &ldquo;SelectedRefinementControlsJson&rdquo; is converted to JSON using PowerShell ConvertFrom-Json method before additional refiners are added. The PowerShell ConvertTo-Json method is used to convert back to JSON before updating the &ldquo;SelectedRefinementControlsJson&rdquo; property. <a href=https://gist.github.com/reshmee011/352aa388e1a8d9641cca28fffb8b6221>https://gist.github.com/reshmee011/352aa388e1a8d9641cca28fffb8b6221</a></p></div><div class=tags></div></div></div><div class="footer wrapper"><nav class=nav><div>2023 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div></body></html>