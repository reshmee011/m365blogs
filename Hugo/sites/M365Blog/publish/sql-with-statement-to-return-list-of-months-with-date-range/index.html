<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>SQL With statement to return list of Months with date range - m365 blog</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://famous-cajeta-4dad83.netlify.app/sql-with-statement-to-return-list-of-months-with-date-range/index.xml title="m365 blog"><meta itemprop=name content="SQL With statement to return list of Months with date range"><meta itemprop=description content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate <= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) <= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp."><meta itemprop=datePublished content="2015-11-20T14:55:44+00:00"><meta itemprop=dateModified content="2015-11-20T14:55:44+00:00"><meta itemprop=wordCount content="152"><meta itemprop=keywords content="SQL,SQL With,"><meta property="og:title" content="SQL With statement to return list of Months with date range"><meta property="og:description" content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate <= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) <= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp."><meta property="og:type" content="article"><meta property="og:url" content="https://famous-cajeta-4dad83.netlify.app/sql-with-statement-to-return-list-of-months-with-date-range/"><meta property="article:section" content><meta property="article:published_time" content="2015-11-20T14:55:44+00:00"><meta property="article:modified_time" content="2015-11-20T14:55:44+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SQL With statement to return list of Months with date range"><meta name=twitter:description content="With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below https://msdn.microsoft.com/en-GB/library/ms175972.aspx I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate <= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) <= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details http://wp."><link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://famous-cajeta-4dad83.netlify.app/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://famous-cajeta-4dad83.netlify.app/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://famous-cajeta-4dad83.netlify.app/css/dark.css><script src=https://famous-cajeta-4dad83.netlify.app/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://famous-cajeta-4dad83.netlify.app/>m365 blog</a></h1><div class=site-description><nav class="nav social"><ul class=flat></ul></nav></div><nav class=nav><ul class=flat></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>20</span>
<span class=rest>Nov 2015</span></div></div><div class=matter><h1 class=title>SQL With statement to return list of Months with date range</h1></div></div><div class=markdown><p>With temporary named result set, known as a common table expression (CTE). More information regarding With can be found from the link below <a href=https://msdn.microsoft.com/en-GB/library/ms175972.aspx>https://msdn.microsoft.com/en-GB/library/ms175972.aspx</a> I have a function that accept a start date and end date and return a list of months CREATE FUNCTION [dbo].[FN_Utility_GetMonths](@startDate DateTime, @EndDate DateTime) RETURNS @Months table (MonthYear nvarchar(25),StartDate DateTime) AS BEGIN ;With [Months] as ( select StartDate = @startDate where @startDate &lt;= @endDate union all select dateadd(month, 1, StartDate) from [Months] M &ndash;iterate through each row to get month benefit where dateadd(Month, 1, StartDate) &lt;= @endDate ) INSERT INTO @Months select CONVERT(VARCHAR(3),StartDate,0) + &lsquo;-&rsquo; + RIGHT(0+YEAR(StartDate),2) ,StartDate from [Months] option (maxrecursion 0) RETURN END The function can be used against a list of rows from a table to break down start date and end date into range of months splitting for example cost information evenly using Apply statement Refer to the following post for more details <a href=http://wp.me/p54RZl-3g>http://wp.me/p54RZl-3g</a></p></div><div class=tags></div></div></div><div class="footer wrapper"><nav class=nav><div>2023 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div></body></html>