<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Invoke-SPOListDesign to create instances of lists/libraires | Reshmee Auckloo</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Creating custom list templates is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates.
This article explores the option how to use a combination of list design and PowerShell script to provision multiple instances of document libraries using a CSV file and how to create a document library from a custom list template from UI."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Invoke-SPOListDesign to create instances of lists/libraires"><meta property="og:description" content="Creating custom list templates is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates.
This article explores the option how to use a combination of list design and PowerShell script to provision multiple instances of document libraries using a CSV file and how to create a document library from a custom list template from UI."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/posts/invoke-spolistdesign-to-create-instances-of-lists-libraires/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-27T00:50:04+00:00"><meta property="article:modified_time" content="2021-10-27T00:50:04+00:00"><meta itemprop=name content="Invoke-SPOListDesign to create instances of lists/libraires"><meta itemprop=description content="Creating custom list templates is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates.
This article explores the option how to use a combination of list design and PowerShell script to provision multiple instances of document libraries using a CSV file and how to create a document library from a custom list template from UI."><meta itemprop=datePublished content="2021-10-27T00:50:04+00:00"><meta itemprop=dateModified content="2021-10-27T00:50:04+00:00"><meta itemprop=wordCount content="1419"><meta itemprop=keywords content="Uncategorized,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Invoke-SPOListDesign to create instances of lists/libraires"><meta name=twitter:description content="Creating custom list templates is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates.
This article explores the option how to use a combination of list design and PowerShell script to provision multiple instances of document libraries using a CSV file and how to create a document library from a custom list template from UI."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee Auckloo</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/share?url=https://reshmee.netlify.app/posts/invoke-spolistdesign-to-create-instances-of-lists-libraires/&amp;text=Invoke-SPOListDesign%20to%20create%20instances%20of%20lists/libraires" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Invoke-SPOListDesign to create instances of lists/libraires</h1><time class="f6 mv4 dib tracked" datetime=2021-10-27T00:50:04Z>October 27, 2021</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p> <a href=https://docs.microsoft.com/en-us/sharepoint/lists-custom-template>Creating custom list templates</a> is now possible to create both custom document libraries and lists although official microsoft documentation has not specified anything about supporting custom document library templates.</p><p>This article explores the option how to use a combination of list design and PowerShell script to provision multiple instances of document libraries using a CSV file and how to create a document library from a custom list template from UI. Although cmdlet Invoke-SPOList Design is not in the official documentation yet. I tried to submit a <a href=https://github.com/MicrosoftDocs/OfficeDocs-SharePoint-PowerShell/pull/49>pull request</a> to include it in their documentation but was eventually closed because they can accept submissions from Microsoft Employees. Below is a snippet of the cmdlet definition.</p><pre tabindex=0><code># Invoke-SPOListDesign

## SYNOPSIS

Applies a published list design to a specified site collection. The supported list templates you can apply a list design to include: &#34;modern&#34; team site with M365 group, &#34;modern&#34; team site without an M365 group, communication site, classic team site, and classic publishing site.

## SYNTAX

```powershell
Invoke-SPOListDesign
  [-Identity] &lt;SPOListDesignPipeBind&gt;
  -WebUrl &lt;string&gt;
  [&lt;CommonParameters&gt;]
</code></pre><h2 id=description>DESCRIPTION</h2><p>Applies a published list design to a specified site collection.</p><h2 id=examples>EXAMPLES</h2><h3 id=example-1>Example 1</h3><p>This example applies a list design whose script creates one list with content types, views and fields.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Invoke-SPOListDesign -Identity 5b38e500-0fab-4da7-b011-ad7113228920 -WebUrl <span style=color:#e6db74>&#34;https://contoso.sharepoint.com/sites/testgo&#34;</span>
</span></span></code></pre></div><h3 id=output>OUTPUT</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>Title                                        OutcomeText Outcome</span>
</span></span><span style=display:flex><span>-----                                        ----------- -------
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column WorkAddress through XML               Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column _Status through XML                   Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column digits through XML                    Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column remarks through XML                   Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column workinghours through XML              Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create site column Progress through XML                  Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create content type Legal                                   NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column WorkAddress to content type                 NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column _Status to content type                     NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create content type test_210304                             NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column digits to content type                      NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column remarks to content type                     NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column workinghours to content type                NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column Progress to content type                    NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column _Status to content type                     NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create content type test_StatusComm                         NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column _Status to content type                     NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create content type test_11                                 NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add site column _Status to content type                     NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Create or update library &#34;test_ct&#34;                       Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;ActualWork&#34;                             Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;Initials&#34;                               Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;_Status&#34;                                Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;digits&#34;                                 Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;remarks&#34;                                Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;workinghours&#34;                           Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;Progress&#34;                               Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;_Comments&#34;                              Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;TriggerFlowInfo&#34;                        Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add list column &#34;SelectFilename&#34;                         Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;Document&#34;                                 NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;Folder&#34;                                   NoOp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;Legal&#34;                                 Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;test_210304&#34;                           Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;test_StatusComm&#34;                       Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add content type &#34;test_11&#34;                               Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add view &#34;All Documents&#34;                                 Success</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Add view &#34;All Documents sorted&#34;                          Success</span>
</span></span></code></pre></div><h2 id=parameters>PARAMETERS</h2><h3 id=-identity>-Identity</h3><p>The ID of the list design to apply.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>Type</span>: <span style=color:#ae81ff>SPOListDesignPipeBind</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Parameter Sets</span>: <span style=color:#ae81ff>(All)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Aliases</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>Applicable</span>: <span style=color:#ae81ff>SharePoint Online</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Required</span>: <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Position</span>: <span style=color:#ae81ff>Named</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Default value</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Accept pipeline input</span>: <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Accept wildcard characters</span>: <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><h3 id=-weburl>-WebUrl</h3><p>The URL of the site collection where the list design will be applied.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>Type</span>: <span style=color:#ae81ff>String</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Parameter Sets</span>: <span style=color:#ae81ff>(All)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Aliases</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>Applicable</span>: <span style=color:#ae81ff>SharePoint Online</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Required</span>: <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Position</span>: <span style=color:#ae81ff>Named</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Default value</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Accept pipeline input</span>: <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Accept wildcard characters</span>: <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><h3 id=commonparameters>CommonParameters</h3><p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see <a href="https://go.microsoft.com/fwlink/?LinkID=113216">about_CommonParameters</a>.</p><h2 id=inputs>INPUTS</h2><h3 id=microsoftonlinesharepointpowershellspolistdesignpipebind>Microsoft.Online.SharePoint.PowerShell.SPOListDesignPipeBind</h3><h2 id=outputs>OUTPUTS</h2><h3 id=systemobject>System.Object</h3><h2 id=notes>NOTES</h2><h2 id=related-links>RELATED LINKS</h2><p>Getting started with <a href="/powershell/sharepoint/sharepoint-online/connect-sharepoint-online?view=sharepoint-ps">SharePoint Online Management Shell</a>.</p><pre tabindex=0><code>
First we can create a list design for our library based on an existing configured document library with custom content types, fields and views.

Create a List design for the document library using **Get-SPOSiteScriptFromList** and **Add-SPOListDesign**
</code></pre><p>Import-Module Microsoft.Online.SharePoint.PowerShell
$adminSiteUrl = &ldquo;<a href=https://contoso-admin.sharepoint.com>https://contoso-admin.sharepoint.com</a>&rdquo;
$listUrl = &ldquo;<a href=https://contoso.sharepoint.com/sites/investment/test_ct%22>https://contoso.sharepoint.com/sites/investment/test_ct"</a></p><p>Connect-SPOService $adminSiteUrl
#$relativeListUrls
$extracted = Get-SPOSiteScriptFromList -ListUrl $listUrl</p><p>Add-SPOSiteScript -Title &ldquo;Test Document Library&rdquo; -Description &ldquo;This creates a custom document library&rdquo; -Content $extracted
$siteScripts = Get-SPOSiteScript</p><p>$siteScriptObj = $siteScripts | Where-Object {$_.Title -eq &ldquo;Test Document Library&rdquo;}</p><p>Add-SPOListDesign -Title &ldquo;Test Document Library&rdquo; -Description &ldquo;Deploy document library with content types and views&rdquo; -SiteScripts $siteScriptObj.Id-ListColor Pink -ListIcon BullseyeTarget</p><pre tabindex=0><code>
From the UI , the list design for the custom library is available when clicking on New &gt;List and selecting the tab &#34;From your organization&#34; under &#34;Templates&#34;

[![](https://reshmeeauckloo.files.wordpress.com/2021/10/image.png?w=421)](https://reshmeeauckloo.files.wordpress.com/2021/10/image.png)

Click on the custom list design to select it , click on &#34;Use Template&#34; button and enter a name and optionally a description for the library. 

Once &#34;Create&#34; is clicked the library is created with the relevant views , content types and fields.

That&#39;s great that we can create a document library using the custom list/library template, however there are some settings like versionings , indexed columns, permissions, etc.. which are not included in the list design template. 

I have used a PowerShell script with the cmdlet Invoke-SPOListDesign to apply the site design recursively to create multiple instances of the document library updating the internal name and display name based on the csv file and update the settings like creating indexed columns and setting versioning.

Sample CSV file format saved as libraries.csv
</code></pre><p>InternalName,DisplayName
AR,Annual Reports
CR,Credit Risk
Audit,Audit
PO,Purchase Orders</p><pre tabindex=0><code>
Execute the **Invoke-SPOListDesign **cmdlet
</code></pre><p>[CmdletBinding()]
Param(
[Parameter(Mandatory=$false, Position=0)]
[String]$adminSiteUrl = &ldquo;<a href=https://contoso-admin.sharepoint.com>https://contoso-admin.sharepoint.com</a>&rdquo;,
[Parameter(Mandatory=$false, Position=1)]
[String]$siteUrl = &ldquo;<a href=https://contoso.sharepoint.com/sites/investment%22>https://contoso.sharepoint.com/sites/investment"</a>,
[Parameter(Mandatory=$false, Position=2)]
[String]$librariesCSV = &ldquo;C:\Scripts\DocumentLibraryTemplate\libraries_1.csv&rdquo;,</p><pre><code>[Parameter(Mandatory=$false,  Position=4)]
[String]$listDesignId = &quot;5b38e500-0fab-4da7-b011-ad7113228920&quot; # use Get-SPOListDesign to find the Id of the list design containing the document library template
</code></pre><p>)
#creating indexed columns might help with performance of large libraries, i.e. >5000 files
function Create-Index ($list, $targetFieldName)
{
$targetField = Get-PnPField -List $list -Identity $targetFieldName
$targetField.Indexed = 1;
$targetField.Update();
$list.Context.ExecuteQuery();
}
Connect-SPOService $adminSiteUrl
Connect-PnPOnline -Url $siteUrl -Interactive
Import-Csv $librariesCSV | ForEach-Object {
Invoke-SPOListDesign -Identity $listDesignId -WebUrl $siteUrl
#Get library just created and update Internal name and display name
$lib = Get-PnPList -Identity &ldquo;test_ct&rdquo; -Includes RootFolder
while(!$lib)
{
$lib = Get-PnPList -Identity &ldquo;test_ct&rdquo; -Includes RootFolder
sleep -second 5
}
if($lib)
{
$lib.Rootfolder.MoveTo($($<em>.InternalName))<br>Invoke-PnPQuery<br>#this will change library title<br>Set-PnPList -Identity $lib.Id -Title $($</em>.DisplayName)
#add list to quick launch
Add-PnPNavigationNode -Title $<em>.DisplayName -Url $($</em>.InternalName + &ldquo;/&rdquo;) -Location &ldquo;QuickLaunch&rdquo;
#enable versioning on the library
Set-PnPList -Identity $lib.Id -EnableVersioning $True -EnableMinorVersions $True -MajorVersions 500 -MinorVersions 10
Write-host &ldquo;`tSetting versioning to major/minor to :"$_.DisplayName
Create-Index $lib &ldquo;Created By&rdquo;
Create-Index $lib &ldquo;Modified&rdquo;
}
}</p><pre tabindex=0><code>
Screenshot of the output running the script. **OutPut**
</code></pre><p>PS C:\Windows\system32> C:\Scripts\DocumentLibraryTemplate\ApplySiteDesignToCreateLibaries.ps1</p><p>Title OutcomeText Outcome</p><hr><p>Create site column WorkAddress through XML Success
Create site column _Status through XML Success
Create site column digits through XML Success
Create site column remarks through XML Success
Create site column workinghours through XML Success
Create site column Progress through XML Success
Create content type Legal NoOp
Add site column WorkAddress to content type NoOp
Add site column _Status to content type NoOp
Create content type test_210304 NoOp
Add site column digits to content type NoOp
Add site column remarks to content type NoOp
Add site column workinghours to content type NoOp
Add site column Progress to content type NoOp
Add site column _Status to content type NoOp
Create content type test_StatusComm NoOp
Add site column _Status to content type NoOp
Create content type test_11 NoOp
Add site column _Status to content type NoOp
Create or update library &ldquo;test_ct&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;ActualWork&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;Initials&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;_Status&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;digits&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;remarks&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;workinghours&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;Progress&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;_Comments&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;TriggerFlowInfo&rdquo; List with name test_ct already exists. NoOp
Add list column &ldquo;SelectFilename&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;Document&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;Folder&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;Legal&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;test_210304&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;test_StatusComm&rdquo; List with name test_ct already exists. NoOp
Add content type &ldquo;test_11&rdquo; List with name test_ct already exists. NoOp
Add view &ldquo;All Documents&rdquo; List with name test_ct already exists. NoOp
Add view &ldquo;All Documents sorted&rdquo; List with name test_ct already exists. NoOp
Annual Reports1<br>Setting versioning to major/minor to : Annual Reports1</p><pre tabindex=0><code>
Screenshot of the libraries created from UI (TestCreatingFromUserInterface) and the others created via script (Annual Reports, Audit, Credit Risk and Purchase Orders)

[![](https://reshmeeauckloo.files.wordpress.com/2021/10/image-1.png?w=1024)](https://reshmeeauckloo.files.wordpress.com/2021/10/image-1.png)

The custom template for list/library can save a lot of time deploying standardised lists/document libraries without having to manually configure views, fields and content types.
</code></pre><ul class=pa0><li class="list di"><a href=/tags/uncategorized/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Uncategorized</a></li></ul><div class="mt6 instapaper_ignoref"><div id=commento></div><script defer src=https://cdn.commento.io/js/commento.js></script></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/pnp-batch-add-delete-300k-items-from-a-sharepoint-online-list/>PnP Batch Add /Delete 300k items from a SharePoint Online list</a></li><li class=mb2><a href=/posts/modern-sharepoint-permission-management-update-site-members-to-contribute/>Modern SharePoint Permission Management : update site members to contribute</a></li><li class=mb2><a href=/posts/prevent-members-in-modern-m365-group-connected-team-sites-to-delete-libraries/>Prevent members in 'Modern' M365 group connected team sites to delete libraries</a></li><li class=mb2><a href=/posts/list-view-threshold-5k-in-sharepoint-online/>List View Threshold 5k in SharePoint Online</a></li><li class=mb2><a href=/posts/migrate-data-from-one-sql-table-to-another-database-table/>Migrate data from one SQL table to another database table</a></li><li class=mb2><a href=/posts/delete-all-list-item-and-file-versions-from-site-and-sub-sites-using-csom-and-powershell/>Delete all list Item and file versions from site and sub sites using CSOM and PowerShell</a></li><li class=mb2><a href=/posts/sql-script-batch-execution-using-sqlcmd-in-powershell/>SQL script batch execution using sqlcmd in PowerShell</a></li><li class=mb2><a href=/posts/sql-script-batch-execution-using-sqlcmd-in-powershell-comments/>SQL script batch execution using sqlcmd in PowerShell</a></li><li class=mb2><a href=/posts/instantiate-crmserviceclient-using-current-users-login/>Instantiate CRMServiceClient using current user's login</a></li><li class=mb2><a href=/posts/instantiate-sharepoint-client-context-using-current-user-credentials-in-powershell/>Instantiate SharePoint Client Context using current user credentials in PowerShell</a></li><li class=mb2><a href=/posts/instantiate-sharepoint-client-context-using-current-user-credentials-in-powershell-comments/>Instantiate SharePoint Client Context using current user credentials in PowerShell</a></li><li class=mb2><a href=/posts/external-sharing-of-documents-with-nintex-in-sharepoint-online/>External Sharing of Documents with Nintex in SharePoint Online</a></li><li class=mb2><a href=/posts/external-sharing-of-documents-with-nintex-in-sharepoint-online-comments/>External Sharing of Documents with Nintex in SharePoint Online</a></li><li class=mb2><a href=/posts/apply-theme-and-create-composed-look-csom-and-powershell/>Apply Theme and Create Composed Look CSOM and PowerShell</a></li><li class=mb2><a href=/posts/importexport-columns-and-content-types-sharepointpnp2016powershell-powershell/>Import/Export Columns and Content Types using PnP PowerShell</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee Auckloo 2023</a><div><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>