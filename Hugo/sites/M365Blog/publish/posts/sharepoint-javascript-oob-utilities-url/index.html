<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>SharePoint JavaScript OOB Utilities URL | Reshmee Auckloo</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="SharePoint JavaScript OOB Utilities URL"><meta property="og:description" content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/posts/sharepoint-javascript-oob-utilities-url/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-12-17T22:17:12+00:00"><meta property="article:modified_time" content="2015-12-17T22:17:12+00:00"><meta itemprop=name content="SharePoint JavaScript OOB Utilities URL"><meta itemprop=description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."><meta itemprop=datePublished content="2015-12-17T22:17:12+00:00"><meta itemprop=dateModified content="2015-12-17T22:17:12+00:00"><meta itemprop=wordCount content="363"><meta itemprop=keywords content="AddKeyValueQueryString,GetUrlKeyValue,IndexOfIllegalCharInUrlPath,JavaScript,ReplaceUrlTokens,SetUrlKeyValue,SharePoint,SharePoint 2013,Uncategorized,URL Utilities,"><meta name=twitter:card content="summary"><meta name=twitter:title content="SharePoint JavaScript OOB Utilities URL"><meta name=twitter:description content="SharePoint provides Out of Box JavaScript libraries to manipulate URL property. GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive) Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive SetUrlKeyValue(keyName, keyValue, bEncode, url) Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee Auckloo</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/share?url=https://reshmee.netlify.app/posts/sharepoint-javascript-oob-utilities-url/&amp;text=SharePoint%20JavaScript%20OOB%20Utilities%20URL" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">SharePoint JavaScript OOB Utilities URL</h1><time class="f6 mv4 dib tracked" datetime=2015-12-17T22:17:12Z>December 17, 2015</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>SharePoint provides Out of Box JavaScript libraries to manipulate URL property. <strong>GetUrlKeyValue(KeyName, bNoDecode, url, bCaseInsensitive)</strong> Gets the key value from url. The second parameter is a Booleans indicating whether the value needs decoding and the last parameter indicates whether key is case sensitive <strong>SetUrlKeyValue(keyName, keyValue, bEncode, url)</strong> Set the value of key in the Url. The third parameter indicates whether the value needs to be encoded The two functions below are useful before saving a file to detect any illegal characters in url and file name as both have different sets of illegal characters. &ldquo;http://&rdquo;, question mark, hash, ssemicolon and ampersand have to be stripped before passing to these functions otherwise they will be interpreted as illegal characters. //check URL <strong>IndexOfIllegalCharInUrlPath(string)</strong> //check file name <strong>IndexOfIllegalCharInUrlLeafName(string)</strong> An example of the use of the functions are below <code>var currentUrl = _spPageContextInfo.webAbsoluteUrl.replace("http://", "") + _spPageContextInfo.serverRequestPath;</code> var illChar = IndexOfIllegalCharInUrlPath(currentUrl); <img src=https://reshmeeauckloo.files.wordpress.com/2015/12/indexillegalchar.jpg alt=indexIllegalChar.JPG> <strong>ReplaceUrlTokens(urlWithTokens,ctx)</strong> Allows to replace all instances of one of six SP specific tokens in a URL {ItemId} {ItemUrl} {SiteUrl} {ListId} {Source} {ListUrlDir} The code below uses the function to obtain listId , SiteUrl and ListUrlDir which is the rootfolder Url of the list. <code>var tokenizedUrl = "http://www.test?list={ListId}&amp;SiteUrl={SiteUrl}&amp;ListDir={ListUrlDir}" var url = ReplaceUrlTokens(tokenizedUrl,ctx); console.log(url) var listId = GetUrlKeyValue ( "List",false, url, true); console.log("ListId:" + listId) var siteUrl = GetUrlKeyValue ( "SiteUrl",false, url, true); console.log("siteUrl" + siteUrl) var ListUrlDir = GetUrlKeyValue ( "ListUrlDir",false, url, true); console.log("ListUrlDir:" + ListUrlDir)</code> <strong>SP.Utilities.UrlBuilder.urlCombine(string1, string2)</strong> Combines the two string parameters without redundant slashes between them. However only works if second string does not begin with a slash. <strong>SP.Utilities.UrlBuilder.removeQueryString(url,key)</strong> Removes key value parameter from url. <code>var urllink = "http://test.com?param1=200&amp;param2=900" console.log(SP.Utilities.UrlBuilder.removeQueryString(urlLink,param1));</code> <strong>SP.Utilities.Utility.getLayoutsPageUrl(pageFileName)</strong> Get relative URL for specific layout page for current context It is useful when writing in a mixed 2010, 2013 mode where some sites have been upgraded <code>alert(SP.Utilities.Utility.getLayoutsPageUrl("SiteSettings.aspx"))</code> <strong>SP.Utilities.UrlBuilder.navigateTo(url)</strong> It takes the browser to specified url. It is useful when the page url is loaded into a SP modal dialog then the new page that gets loaded will remain inside that dialog as well. Copy the code into a script editor web part to test. <code>&lt;a onclick="SP.Utilities.UrlBuilder.navigateTo('http://www.google.com')">Navigate in Dialog&lt;/a> &lt;a href='http://www.google.com')">Navigate without Dialog&lt;/a></code> <strong>AddKeyValueQueryString(key,value)</strong> var testUrl = SP.Utilities.Utility.getLayoutsPageUrl(&ldquo;test.aspx&rdquo;) var urlBuilder = SP.Utilities.UrlBuilder(testUrl); urlBuilder.AddKeyValueQueryString(&ldquo;param&rdquo;,&ldquo;112&rdquo;); console.log( urlBuilder.get_url());</p><ul class=pa0><li class="list di"><a href=/tags/addkeyvaluequerystring/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">AddKeyValueQueryString</a></li><li class="list di"><a href=/tags/geturlkeyvalue/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">GetUrlKeyValue</a></li><li class="list di"><a href=/tags/indexofillegalcharinurlpath/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">IndexOfIllegalCharInUrlPath</a></li><li class="list di"><a href=/tags/javascript/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">JavaScript</a></li><li class="list di"><a href=/tags/replaceurltokens/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">ReplaceUrlTokens</a></li><li class="list di"><a href=/tags/seturlkeyvalue/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SetUrlKeyValue</a></li><li class="list di"><a href=/tags/sharepoint/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SharePoint</a></li><li class="list di"><a href=/tags/sharepoint-2013/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SharePoint 2013</a></li><li class="list di"><a href=/tags/uncategorized/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Uncategorized</a></li><li class="list di"><a href=/tags/url-utilities/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">URL Utilities</a></li></ul><div class="mt6 instapaper_ignoref"><div id=commento></div><script defer src=https://cdn.commento.io/js/commento.js></script></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/sharepoint-approve-selected-list-items/>SharePoint, Approve Selected List Items</a></li><li class=mb2><a href=/posts/sharepoint-approve-selected-list-items-comments/>SharePoint, Approve Selected List Items</a></li><li class=mb2><a href=/posts/rest-or-csom-with-javascript-to-find-if-user-is-in-particular-sharepoint-group/>REST or CSOM with JavaScript to find if user is in particular SharePoint group</a></li><li class=mb2><a href=/posts/csom-sharepoint-update-created-field-of-infopath-file-in-document-library/>CSOM SharePoint Update Created Field of InfoPath file in Document Library</a></li><li class=mb2><a href=/posts/passing-date-parameter-to-subreport-ssrs-sharepoint-integrated-mode/>Passing Date Parameter To SubReport SSRS SharePoint Integrated Mode</a></li><li class=mb2><a href=/posts/form-submit-from-a-webpart-sharepoint/>Form Submit from a WebPart SharePoint</a></li><li class=mb2><a href=/posts/update-user-profile-property-using-web-service-request-action-in-nintex/>Update User Profile Property using Web Service Request action in Nintex</a></li><li class=mb2><a href=/posts/getfieldvalueashtml-on-multiline-textboxes-return-instead-of/>GetFieldValueAsHTML on multiline textboxes return instead of</a></li><li class=mb2><a href=/posts/exchange-activesync/>Exchange ActiveSync</a></li><li class=mb2><a href=/posts/clojure-loop-doseqdotimes-while-loop-recur/>Clojure loop: doseq,dotimes, while, loop, recur</a></li><li class=mb2><a href=/posts/clojure-if-cond-case-comments/>Clojure If, cond, case</a></li><li class=mb2><a href=/posts/clojure-if-cond-case/>Clojure If, cond, case</a></li><li class=mb2><a href=/posts/ssrs-format-currency-in-thousands-with-suffix-k/>SSRS Format Currency in thousands with suffix K</a></li><li class=mb2><a href=/posts/clojure-sequences/>Clojure Sequences</a></li><li class=mb2><a href=/posts/clojure-immutable-collections/>Clojure Immutable Collections</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee Auckloo 2023</a><div><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>