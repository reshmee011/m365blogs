<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action | Reshmee Auckloo</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta property="og:description" content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/posts/nintex-workflow-sharepoint-online-create-sub-site-http-web-service/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-11-28T22:36:21+00:00"><meta property="article:modified_time" content="2015-11-28T22:36:21+00:00"><meta itemprop=name content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta itemprop=description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"><meta itemprop=datePublished content="2015-11-28T22:36:21+00:00"><meta itemprop=dateModified content="2015-11-28T22:36:21+00:00"><meta itemprop=wordCount content="511"><meta itemprop=keywords content="Nintex,Nintex Workflow,SharePoint Online,Uncategorized,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action"><meta name=twitter:description content="In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx for more info)
Allow workflow to use app permissions a. Navigate to site settings"></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee Auckloo</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/share?url=https://reshmee.netlify.app/posts/nintex-workflow-sharepoint-online-create-sub-site-http-web-service/&amp;text=Nintex%20Workflow%20SharePoint%20Online%20Create%20Sub%20Site%20using%20Call%20HTTP%20Web%20Service%20Action" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action</h1><time class="f6 mv4 dib tracked" datetime=2015-11-28T22:36:21Z>November 28, 2015</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>In SharePoint Online, Nintex Workflow has an action named Call HTTP Web Service. The action can be used to call SharePoint REST API, i.e. /_api/web/webinfos/add endpoint to create web site. The workflow app needs to be given full control at the site collection. The app permissions for workflow can be configured by following the steps below (refer to <a href="https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx">https://msdn.microsoft.com/en-us/library/office/jj822159(v=office.15).aspx</a> for more info)</p><ol><li>Allow workflow to use app permissions</li></ol><p> a. Navigate to site settings</p><p> b. Under Site Actions, click Manage site features</p><p>c. Locate the Workflows can app permissions and click Activate if it is not activated yet.</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/workflowcan-use-app-permissions.jpg alt="WorkflowCan use app permissions">2. Allow workflow to use app permissions</p><p>3.Navigate to site settings> site app permissions</p><p><a href=https://reshmeeauckloo.files.wordpress.com/2015/11/site-app-permissions.jpg><img src="https://reshmeeauckloo.files.wordpress.com/2015/11/site-app-permissions.jpg?w=300" alt="Site App Permissions"></a> Note down the workflow app id which is between i:0i.t|ms.sp.ext| and @</p><p>4. Navigate to /_layouts/15/appinv.aspx</p><p>5. Enter workflow app id  and click on Lookup button 6. Enter the following in Permission Request XML</p><p>&lt;AppPermissionRequest Scope="<a href=http://sharepoint/content/sitecollection title=http://sharepoint/content/sitecollection>http://sharepoint/content/sitecollection</a>" Right=&ldquo;FullControl&rdquo; />     <a href=https://reshmeeauckloo.files.wordpress.com/2015/11/grantpermissions.jpg><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/grantpermissions.jpg alt=GrantPermissions></a></p><p>7.Click on Create 8.Click on Trust the app.</p><p>The logic of the Nintex Workflow was built using the <a href=http://blog.vgrem.com/2014/05/08/consuming-the-sharepoint-2013-rest-service-from-sharepoint-designer/>Consuming the SharePoint 2013 REST Service from SharePoint Designer</a> that describes how to configure Call HTTP Web Service Action in order to create web site. Create a new Nintex Workflow against a custom list with Title column only using the Nintex Workflow Designer</p><ol><li>Use &ldquo;Set Workflow Variable&rdquo; action to create and assign variable RequestURL /_api/web/webinfos/add</li></ol><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/1-set-workflow-variable-requesturl1.jpg alt="1.Set Workflow Variable RequestURL"></p><p>2. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign Title</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/4-set-workflow-variable-title1.jpg alt="4.Set Workflow Variable Title"></p><p>3. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign SiteURL the expected URL</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/3-set-workflow-variable-siteurl1.jpg alt="3.Set Workflow Variable SiteUrl"></p><p>4. Use &ldquo;Set Workflow Variable&rdquo; action to create and assign variable SiteTemplate</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/2-set-workflow-variable-site-template.jpg alt="2.Set Workflow Variable Site Template"></p><p>5. Use action &ldquo;Build Dictionary&rdquo; to build Dictionary RequestHeaders.</p><p><img src=https://reshmeeauckloo.files.wordpress.com/2015/11/5-build-dictionary-requestheader.jpg alt="5.Build Dictionary RequestHeader"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> Accept</p><p>Text</p><p> application/json;odata=verbose</p><p> Content-Type</p><p>Text</p><p> application/json;odata=verbose</p><p>Table 1. Request Headers for a RequestHeaders dictionary variable 6. Use action &ldquo;Build Dictionary&rdquo; to build Dictionary MetaData.<img src=https://reshmeeauckloo.files.wordpress.com/2015/11/6-build-dictionary-metadata.jpg alt="6.Build Dictionary Metadata"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> type</p><p>Text</p><p> SP.WebInfoCreationInformation</p><p>Table 2.  Metadata dictionary variable 7. Use action &ldquo;Build Dictionary&rdquo; to  build Dictionary Parameters. <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/7-build-dictionary-parameters.jpg alt="7.Build Dictionary Parameters"> Add key pair values as described in the table below</p><p>Name</p><p>Type</p><p>Value</p><p> __metadata</p><p>Dictionary</p><p>Workflow Variable:Metadata</p><p> Url</p><p>Text</p><p>Workflow Variable:Title</p><p> Title</p><p>Text</p><p>Workflow Variable:Title</p><p> Description</p><p>Text</p><p>Workflow Variable:Title</p><p> Language</p><p>Text</p><p> Value:1033</p><p> WebTemplate</p><p>Text</p><p> Workflow Variable: sts</p><p> UseIniquePermissions</p><p> Boolean</p><p> Value:No</p><p>Table 3.  Parameters dictionary variable 8. Create App Step <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/9-1app-step.jpg alt="9.1App Step"> 9. Add and Configure the HTTP Web Service <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/9-call-http-web-service.jpg alt="9.Call HTTP Web Service"></p><p>Property Name</p><p>Value</p><p> Address</p><p>Set value to variable RequestUrl that was created in step 1</p><p> RequestType</p><p>Set value to HTTP POST</p><p> RequestHeaders</p><p>Set value to dictionary variable RequestHeaders that we’ve constructed to store request header properties in step 5</p><p> ResponseContent</p><p>Create a new dictionary variable named ResponseContent to store the body of this HTTP request</p><p>ResponseHeaders</p><p>Create a new dictionary variable ResponseHeaders to store the response headers of this HTTP request.</p><p>ResponseStatusCode</p><p>Create a new text variable named ResponseStatusCode  to store the response status code of this HTTP request.</p><p>Table 4. HTTP Web Service Action configuration Publish the workflow against the list and run workflow against an item in the list to create a subsite with the title specified. <img src=https://reshmeeauckloo.files.wordpress.com/2015/11/workflow.jpg alt=Workflow></p><ul class=pa0><li class="list di"><a href=/tags/nintex/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Nintex</a></li><li class="list di"><a href=/tags/nintex-workflow/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Nintex Workflow</a></li><li class="list di"><a href=/tags/sharepoint-online/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SharePoint Online</a></li><li class="list di"><a href=/tags/uncategorized/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Uncategorized</a></li></ul><div class="mt6 instapaper_ignoref"><div id=commento></div><script defer src=https://cdn.commento.io/js/commento.js></script></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/nintex-workflow-sharepoint-online-create-sub-site-http-web-service-comments/>Nintex Workflow SharePoint Online Create Sub Site using Call HTTP Web Service Action</a></li><li class=mb2><a href=/posts/update-user-profile-property-using-web-service-request-action-in-nintex/>Update User Profile Property using Web Service Request action in Nintex</a></li><li class=mb2><a href=/posts/c-remove-method/>C# Remove Method</a></li><li class=mb2><a href=/posts/date-crawled-properties-search-sharepoint-online-fql-optional-date-filter-if-date-is-null-comments/>Date Crawled properties Search SharePoint Online KQL Optional Date Filter if Date is null</a></li><li class=mb2><a href=/posts/date-crawled-properties-search-sharepoint-online-fql-optional-date-filter-if-date-is-null/>Date Crawled properties Search SharePoint Online KQL Optional Date Filter if Date is null</a></li><li class=mb2><a href=/posts/kql-sharepoint-online-filtering-on-user-profile-multi-values-managed-metadata-properties/>KQL SharePoint Online filtering on user profile multi values managed metadata properties</a></li><li class=mb2><a href=/posts/convert-utc-date-returned-from-sharepoint-api-to-local-time-using-javascript-and-c/>Convert UTC Date returned from SharePoint API to Local time using JavaScript and C#</a></li><li class=mb2><a href=/posts/sharepoint-get-list-items-and-effective-permissions-on-a-list-via-rest-api-from-sharepoint-add-in-comments/>SharePoint Get list items and Effective Permissions on a list via REST API from SharePoint Add-in</a></li><li class=mb2><a href=/posts/sharepoint-get-list-items-and-effective-permissions-on-a-list-via-rest-api-from-sharepoint-add-in/>SharePoint Get list items and Effective Permissions on a list via REST API from SharePoint Add-in</a></li><li class=mb2><a href=/posts/form-submit-from-a-webpart-sharepoint/>Form Submit from a WebPart SharePoint</a></li><li class=mb2><a href=/posts/getfieldvalueashtml-on-multiline-textboxes-return-instead-of/>GetFieldValueAsHTML on multiline textboxes return instead of</a></li><li class=mb2><a href=/posts/office-365-how-to-change-settings-for-lync-meetings/>Office 365 - how to change settings to allow authenticated users to join meetings</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee Auckloo 2023</a><div><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>