<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP | Reshmee Auckloo</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."><meta name=generator content="Hugo 0.111.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP"><meta property="og:description" content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."><meta property="og:type" content="article"><meta property="og:url" content="https://reshmee.netlify.app/posts/metalogix-import-from-fileshare-to-sharepoint-extract-folder-name-from-filepath-using-csom-pnp/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-08-26T21:05:05+00:00"><meta property="article:modified_time" content="2016-08-26T21:05:05+00:00"><meta itemprop=name content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP"><meta itemprop=description content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."><meta itemprop=datePublished content="2016-08-26T21:05:05+00:00"><meta itemprop=dateModified content="2016-08-26T21:05:05+00:00"><meta itemprop=wordCount content="552"><meta itemprop=keywords content="CSOM,FilePath Extract Folder Name,Metalogix,Metalogix FileShare,PnP,SharePoint 2013,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP"><meta name=twitter:description content="I was evaluating the Metalogix tool for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:
Migrate files recursively from within folders , i.e. flatten folder Replace illegal characters with character specified Handle duplicate by either overwriting file or not moving file The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns Can apply custom filter on the following Created Before Created After Modified Before Modified After File Size Max Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Reshmee Auckloo</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/share?url=https://reshmee.netlify.app/posts/metalogix-import-from-fileshare-to-sharepoint-extract-folder-name-from-filepath-using-csom-pnp/&amp;text=Metalogix%20Import%20From%20FileShare%20To%20SharePoint%20-%20Extract%20Folder%20Name%20from%20FilePath%20using%20CSOM%20PnP" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Metalogix Import From FileShare To SharePoint - Extract Folder Name from FilePath using CSOM PnP</h1><time class="f6 mv4 dib tracked" datetime=2016-08-26T21:05:05Z>August 26, 2016</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I was evaluating the <a href=http://www.metalogix.com/Products/Content-Matrix.aspx>Metalogix tool</a> for Migration from fileshare to SharePoint. The file share edition needs to be selected while installing the Metalogix content matrix tool. The good news is that it can fulfil the following requirements:</p><ul><li>Migrate files recursively from within folders , i.e. flatten folder</li><li>Replace illegal characters with character specified</li><li>Handle duplicate by either overwriting file or not moving file</li><li>The CreatedBy, CreatedDate, ModifedBy and ModifiedDate file properties can be maintained by mapping these properties to SharePoint respective Out of the Box columns</li><li>Can apply custom filter on the following<ul><li>Created Before</li><li>Created After</li><li>Modified Before</li><li>Modified After</li><li>File Size Max</li></ul></li></ul><p><img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixcustomfilters.png alt=MetalogixCustomFilters></p><ul><li>Can migrate user permission as set on the folder/file from fileShare to SharePoint, however I could not find option how to map to SharePoint Groups.</li><li>Can migrate sub folders</li><li>Incremental migrate</li><li>Migration can be scheduled, in scenario where migration needs to be run out of office hours</li><li>Can extract custom properties on file using “Extracting MS Office File Properties”</li></ul><p>I was stuck how to extract different level of folder names for nested folders. The folder names represent useful metadata which we wanted to migrate also. I managed to extract the top level folder using RegEx expression. I created a new column &ldquo;Folder&rdquo; from the &ldquo;Items View &ldquo;tab for the file share location. Right clicking on the view brings the option &ldquo;Extract Content from Property&rdquo; . <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractcontentfromproperty.png alt=MetalogixExtractContentFromProperty> I used Regex ** [^\\]+(?=\\[^\\]+$)** on the Metalogix [Source Url] column and extracted the result to column [Folder] created above. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderusingregex.png alt=MetalogixExtractFolderUsingRegex> After running the extraction, the column Folder is correctly populated with the folder name in which the file resides. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfoldername.png alt=MetalogixExtractFolderName> I was trying to figure out how to retrieve various folder levels from a path and map them to different columns. Let&rsquo;s say the folder structure is \Server\First Level Folder\Second Level Folder\Third Level Folder\My File.extension From the above method I managed to retrieve only [Third Level Folder] name. If I want to retrieve [Second Level Folder], then I have to use a different regex together <strong>^(?:[^\\]*\\){4}([^\\]*)</strong> with the regex above ** [^\\]+(?=\\[^\\]+$)** <em>The number {4} can be updated to get different folder levels.</em> The regex can be tested from Windows PowerShell and correct result is returned by applying both regex expressions. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/testregextoretrievedifferentlevel.png alt=TestRegexToRetrieveDifferentLevel> I created two additional columns [tmpLevel1] and [Level1] from the file share location [Items View] tab. Using the  regex <strong>^(?:[^\\]*\\){4}([^\\]*),</strong> I extracted the path into column [tmpLevel1] which is in the format " \Server\First Level Folder\Second Level Folder\Third Level Folder&rdquo; <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelusingregex.png alt=MetalogixExtractFolderLevelUsingRegex> I repeated the process but this time using <strong>[^\\]+(?=\\[^\\]+$)</strong> on column [tmpLevel1] to save result in column [Level1]. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelfinalusingregex.png alt=MetalogixExtractFolderLevelFinalUsingRegex> The final results is now I have the third level and second level folder name.<img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixextractfolderlevelresultspng.png alt=MetalogixExtractFolderLevelResultspng> The issue however is that the steps need to be repeated for each new file share location making the deployment steps quite cumbersome. The other option is to keep the migration step simple mapping just Out of Box fields. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixfieldmappings.png alt=MetalogixFieldMappings> After files are migrated to SharePoint, the column [MigrationSourceURL] is created and populated by default in the library. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/metalogixmigrationsourceurl.png alt=MetalogixMigrationSourceURL> Thus running the PowerShell using CSOM script below after migration the columns Level0 and Level1 can be populated with the folder names. The value from column &ldquo;MigrationSourceURL&rdquo; is retrieved for all documents and split into level 0 and level 1. <a href=https://gist.github.com/reshmee011/dfe0b6fa3eb3d8f59e9d0415f66662d7>https://gist.github.com/reshmee011/dfe0b6fa3eb3d8f59e9d0415f66662d7</a> After running the script, the Level0 and Level1 columns are populated. <img src=https://reshmeeauckloo.files.wordpress.com/2016/08/documentslevel01afterpwcsom.png alt=DocumentsLevel01AfterPWCSOM></p><ul class=pa0><li class="list di"><a href=/tags/csom/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">CSOM</a></li><li class="list di"><a href=/tags/filepath-extract-folder-name/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">FilePath Extract Folder Name</a></li><li class="list di"><a href=/tags/metalogix/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Metalogix</a></li><li class="list di"><a href=/tags/metalogix-fileshare/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Metalogix FileShare</a></li><li class="list di"><a href=/tags/pnp/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">PnP</a></li><li class="list di"><a href=/tags/sharepoint-2013/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SharePoint 2013</a></li></ul><div class="mt6 instapaper_ignoref"><div id=commento></div><script defer src=https://cdn.commento.io/js/commento.js></script></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/update-choice-field-values-using-csom-in-powershell/>Update Choice Field values using CSOM in PowerShell</a></li><li class=mb2><a href=/posts/importexport-columns-and-content-types-sharepointpnp2016powershell-powershell-comments/>Import/Export Columns and Content Types using PnP PowerShell</a></li><li class=mb2><a href=/posts/importexport-columns-and-content-types-sharepointpnp2016powershell-powershell/>Import/Export Columns and Content Types using PnP PowerShell</a></li><li class=mb2><a href=/posts/csom-query-all-unique-permissions/>CSOM in PowerShell Query All Unique Permissions</a></li><li class=mb2><a href=/posts/jsom-sharepoint-online-create-term-with-custom-shared-and-local-properties/>JSOM SharePoint Online Create Term with custom shared and local properties</a></li><li class=mb2><a href=/posts/sharepoint-jsom-to-update-document-id-settings/>SharePoint JSOM to update Document ID Settings</a></li><li class=mb2><a href=/posts/sharepoint-2013-how-to-increase-the-file-upload-limit-for-csom-from-2-mb-to-20-mb-comments/>SharePoint 2013: How to increase the file upload limit for CSOM from 2 Mb to 20 Mb</a></li><li class=mb2><a href=/posts/sharepoint-2013-how-to-increase-the-file-upload-limit-for-csom-from-2-mb-to-20-mb/>SharePoint 2013: How to increase the file upload limit for CSOM from 2 Mb to 20 Mb</a></li><li class=mb2><a href=/posts/sharepoint-2013-csom-rest-web-proxy/>SharePoint 2013/Online CSOM REST Web Proxy</a></li><li class=mb2><a href=/posts/sharepoint-2013-csom-rest-web-proxy-comments/>SharePoint 2013/Online CSOM REST Web Proxy</a></li><li class=mb2><a href=/posts/updating-resources-custom-field-values-using-csom-project-online-project-server-2013/>Updating Resources Custom Field values using CSOM, Project Online, #Project Server 2013</a></li><li class=mb2><a href=/posts/rest-or-csom-with-javascript-to-find-if-user-is-in-particular-sharepoint-group/>REST or CSOM with JavaScript to find if user is in particular SharePoint group</a></li><li class=mb2><a href=/posts/nintex-sharepoint-online-create-sharepoint-group-with-contribute-permissions-comments/>Nintex SharePoint Online Create SharePoint Group with Contribute permissions</a></li><li class=mb2><a href=/posts/nintex-sharepoint-online-create-sharepoint-group-with-contribute-permissions/>Nintex SharePoint Online Create SharePoint Group with Contribute permissions</a></li><li class=mb2><a href=/posts/powershell-break-inheritance-on-sharepoint-library-and-change-permissions-of-group/>PowerShell break inheritance on SharePoint Library and change permissions of Group</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://reshmee.netlify.app/>&copy; Reshmee Auckloo 2023</a><div><div class=ananke-socials><a href=https://twitter.com/reshmeeauckloo target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>