---
title: 'Import Configuration Data to CRM using Microsoft.Xrm.Data.PowerShell'
date: Thu, 24 Nov 2016 17:42:09 +0000
draft: false
tags: ['CRM Dynamics 2015', 'Data Migration', 'Data.xml', 'DataSchema.xml', 'Import Configuration Data', 'Microsoft.Xrm.Data.PowerShell', 'PowerShell']
---

CRM Dynamics data can be exported using the [data migration tool](https://technet.microsoft.com/en-us/library/dn647422(v=crm.7).aspx) by first generating the data schema file and using the later to export selected entities and fields. The same data migration tool can be used to [import data](https://technet.microsoft.com/en-us/library/dn647419(v=crm.7).aspx) into other environments. However it is still a manual process. I have written a script using [Microsoft.Xrm.Data.PowerShell](https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell) module in PowerShell  to automate the data import. The zip generated by the export needs to be unzipped so that the path of the files can be passed to the method called to import the data.![unzippedconfigfile](https://reshmeeauckloo.files.wordpress.com/2016/11/unzippedconfigfile.png) The script can be downloaded from [TechNet gallery](https://gallery.technet.microsoft.com/Import-config-data-to-CRM-b98f02fb?redir=0). Please note that the script has been tested with limited data so might require changes depending on the data being imported. https://gist.github.com/reshmee011/a55109231931ed0217f2a90655fe0be6 Call the method Import-ConfigData as in the snippet below.```
 Add-type -Path ".\\Assemblies\\Microsoft.Xrm.Tooling.CrmConnectControl.dll"
 Add-Type -Path ".\\Assemblies\\Microsoft.Xrm.Tooling.Connector.dll"

import-module ".\\Microsoft.Xrm.Data.PowerShell\\Microsof t.Xrm.Data.PowerShell.psm1"

$crmOrg = New-Object \`         
   \-TypeName Microsoft.Xrm.Tooling.Connector.CrmServiceClient \`         
   \-ArgumentList (\[System.Net.CredentialCache\]::DefaultNetworkCredentials),             (\[Microsoft.Xrm.Tooling.Connector.AuthenticationType\]::AD) 
,            $serverName 
,            $serverPort 
,             $organizationName 
,             $False 
,            $False 
,           (\[Microsoft.Xrm.Sdk.Discovery.OrganizationDetail\]$null) 
$dataFilePath =  "\\PkgFolder\\Configuration Data\\data.xml" 
$dataSchemaFilePath = "\\PkgFolder\\Configuration Data\\data\_schema.xml" 
Write\-Output "Begin import of configuration data..." 
Import\-ConfigData \-dataFilePath $dataFilePath 
\-dataSchemaFilePath $dataSchemaFilePath \-crmOrg $crmOrg 
Write\-Output "End import of configuration data..." 
```First initialise the crm connection object of type Microsoft.Xrm.Tooling.Connector.CrmServiceClient stored in the variable $crmOrg above. Pass the following parameters to the method. datafilePath: Path of the file data.xml crmOrg  : crm connection object dataschemafilepath: Path of the file dataschema.xml