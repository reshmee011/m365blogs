---
title: 'Project Server 2013 Make fields Read Only in PDP depending on SharePoint Groups the logged user belong to'
date: Thu, 24 Dec 2015 17:04:35 +0000
draft: false
tags: ['JavaScript', 'JSOM', 'Permissions SharePoint Group JQuery', 'Project Server 2013', 'Project Server 2013 PDP JavaScript', 'SharePoint 2013', 'SharePoint 2013 CSOM', 'Uncategorized']
---

I had a requirement depending on the SharePoint group the user belong some fields need to be read only. The script below disable the field  "Project Code" on the PDP (Project Detail Page) if the user is not in the SharePoint group "Project Code". Copy the code snippet to a script editor web part in a PDP page. jQuery.noConflict(); function IsCurrentUserMemberOfGroup(groupName, OnComplete) { var currentContext = new SP.ClientContext.get\_current(); var currentWeb = currentContext.get\_web(); var currentUser = currentContext.get\_web().get\_currentUser(); currentContext.load(currentUser); var allGroups = currentWeb.get\_siteGroups(); currentContext.load(allGroups); var group = allGroups.getByName(groupName); currentContext.load(group); var groupUsers = group.get\_users(); currentContext.load(groupUsers); currentContext.executeQueryAsync(OnSuccess,OnFailure); function OnSuccess(sender, args) { var userInGroup = false; var groupUserEnumerator = groupUsers.getEnumerator(); while (groupUserEnumerator.moveNext()) { var groupUser = groupUserEnumerator.get\_current(); if (groupUser.get\_id() == currentUser.get\_id()) { userInGroup = true; break; } } OnComplete(userInGroup); } function OnFailure(sender, args) { OnComplete(false); } } function IsCurrentUserHasContribPerms() { if (!jQuery('input\[title="Project Code"\]').prop('disabled') ) { console.log(jQuery('input\[title="Project Code"\]').prop('disabled')); IsCurrentUserMemberOfGroup("Project Code", function (isCurrentUserInGroup) { if(isCurrentUserInGroup) { jQuery('input\[title="Project Code"\]').prop('disabled',false); } else { // alert("user not in group"); jQuery('input\[title="Project Code"\]').prop('disabled',true); } }); } } ExecuteOrDelayUntilScriptLoaded(function(){setInterval(IsCurrentUserHasContribPerms, 250)}, 'SP.js');